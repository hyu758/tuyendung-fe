import{B as M,u as C,k as o,o as N,r as B,c as k,a as i,e as s,s as f,d as w,z as x,q as $,g as h,w as P,f as q,C as R}from"./index-D4VaI7ts.js";import{_ as y}from"./BaseInput-B9rQ69W7.js";import{_ as b}from"./BaseButton-BaAFRq2x.js";import{a as p,s as S}from"./notifications-BdlxHN63.js";const T={class:"bg-gray-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8"},z={class:"max-w-md mx-auto"},E={class:"bg-white py-8 px-6 shadow rounded-lg"},I={class:"space-y-6"},K={key:3,class:"text-center"},U={class:"mt-6 text-center"},L={class:"text-sm text-gray-600"},F={__name:"ResetPassword",setup(Q){const _=M(),g=C(),r=o(""),c=o(""),a=o({}),n=o(""),u=o(!1),t=o(""),v=o("");N(()=>{v.value=_.params.token,v.value||(t.value="Mã đặt lại mật khẩu không hợp lệ hoặc đã hết hạn.",p("Mã đặt lại mật khẩu không hợp lệ hoặc đã hết hạn."),setTimeout(()=>{g.push("/forgot-password")},3e3))});const V=async()=>{a.value={};let l=!0;if(r.value?r.value.length<8&&(a.value.password="Mật khẩu phải có ít nhất 8 ký tự",l=!1):(a.value.password="Mật khẩu không được để trống",l=!1),c.value?r.value!==c.value&&(a.value.confirmPassword="Mật khẩu xác nhận không khớp",l=!1):(a.value.confirmPassword="Vui lòng xác nhận mật khẩu",l=!1),!!l){u.value=!0,t.value="";try{const m=(await R.post(`/api/reset-password/${v.value}`,{password:r.value})).data;m.status===200?(n.value="Mật khẩu đã được đặt lại thành công.",S("Mật khẩu đã được đặt lại thành công. Bạn có thể đăng nhập ngay bây giờ."),setTimeout(()=>{g.push("/login")},3e3)):(t.value=m.error||"Có lỗi xảy ra khi đặt lại mật khẩu. Vui lòng thử lại.",p(t.value))}catch(e){console.error("Lỗi đặt lại mật khẩu:",e),e.response?(t.value=e.response.data.error||"Có lỗi xảy ra khi đặt lại mật khẩu. Vui lòng thử lại.",p("Có lỗi xảy ra khi đặt lại mật khẩu. Vui lòng thử lại.")):(t.value="Không thể kết nối đến máy chủ. Vui lòng thử lại sau.",p("Không thể kết nối đến máy chủ. Vui lòng thử lại sau."))}finally{u.value=!1}}};return(l,e)=>{const m=B("router-link");return i(),k("div",T,[s("div",z,[e[6]||(e[6]=s("div",{class:"text-center mb-8"},[s("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Đặt lại mật khẩu"),s("p",{class:"text-gray-600"},"Nhập mật khẩu mới cho tài khoản của bạn")],-1)),s("div",E,[n.value?(i(),f(x,{key:0,variant:"success",message:n.value,show:!!n.value,class:"mb-6"},null,8,["message","show"])):w("",!0),t.value?(i(),f(x,{key:1,variant:"error",message:t.value,show:!!t.value,class:"mb-6"},null,8,["message","show"])):w("",!0),n.value?(i(),k("div",K,[e[3]||(e[3]=s("i",{class:"fas fa-check-circle text-green-500 text-5xl mb-4"},null,-1)),e[4]||(e[4]=s("p",{class:"text-gray-700 mb-6"},"Mật khẩu của bạn đã được đặt lại thành công.",-1)),h(b,{variant:"primary",label:"Đăng nhập",onClick:e[2]||(e[2]=d=>l.$router.push("/login")),class:"w-full"})])):(i(),k("form",{key:2,onSubmit:$(V,["prevent"])},[s("div",I,[h(y,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=d=>r.value=d),type:"password",label:"Mật khẩu mới",placeholder:"Nhập mật khẩu mới",autocomplete:"new-password",required:"",prefixIcon:"lock",error:a.value.password},null,8,["modelValue","error"]),h(y,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=d=>c.value=d),type:"password",label:"Xác nhận mật khẩu",placeholder:"Nhập lại mật khẩu mới",autocomplete:"new-password",required:"",prefixIcon:"lock",error:a.value.confirmPassword},null,8,["modelValue","error"]),s("div",null,[h(b,{type:"submit",variant:"primary",size:"lg",label:u.value?"Đang xử lý...":"Đặt lại mật khẩu",loading:u.value,disabled:u.value,class:"w-full"},null,8,["label","loading","disabled"])])])],32))]),s("div",U,[s("p",L,[h(m,{to:"/login",class:"font-medium text-blue-600 hover:text-blue-500"},{default:P(()=>e[5]||(e[5]=[s("i",{class:"fas fa-arrow-left mr-1"},null,-1),q(" Quay lại đăng nhập ")])),_:1})])])])])}}};export{F as default};
