import{_ as D,j as k,E as m,c as o,o as n,b as g,d as a,t as d,q as i,n as b,F as w,e as I}from"./index-DrXs9fRt.js";const N={class:"space-y-2"},E=["for"],U={class:"relative"},A={class:"mb-4"},K={key:0,class:"relative"},L=["src","alt"],M={class:"absolute top-2 right-2 flex space-x-2 z-10"},W={key:1,class:"p-4 flex flex-col items-center justify-center text-center"},q={class:"mb-3"},R={key:0,class:"bg-blue-100 text-blue-600 rounded-full p-3 mx-auto"},O={key:1,class:"bg-gray-100 text-gray-400 rounded-full p-3 mx-auto"},X={key:0,class:"text-sm text-gray-800 font-medium mb-1 truncate max-w-full"},G={class:"text-sm text-gray-500 mb-2"},H=["id","accept"],J={key:1,class:"mt-1 text-sm text-red-600"},P={key:2,class:"mt-1 text-sm text-gray-500"},Q={__name:"BaseFileUpload",props:{modelValue:{type:[File,String,null],default:null},label:{type:String,default:""},placeholder:{type:String,default:""},accept:{type:String,default:"image/*"},error:{type:String,default:""},helpText:{type:String,default:""},previewType:{type:String,default:"cover",validator:t=>["cover","contain"].includes(t)},previewContainerClass:{type:String,default:"h-48 w-full"},icon:{type:String,default:"fas fa-cloud-upload-alt"},maxSize:{type:Number,default:5*1024*1024},alt:{type:String,default:""},name:{type:String,default:""}},emits:["update:modelValue","error"],setup(t,{emit:S}){const l=t,u=S,c=k(null),v=k(!1),h=m(()=>l.name||`file-upload-${Date.now()}`),F=m(()=>l.modelValue?l.modelValue instanceof File?URL.createObjectURL(l.modelValue):l.modelValue:""),C=m(()=>l.modelValue?l.modelValue instanceof File?l.modelValue.name:"File đã tải lên":""),T=m(()=>{if(!l.modelValue||!(l.modelValue instanceof File))return"";const r=l.modelValue.size;return r<1024?`${r} B`:r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/(1024*1024)).toFixed(1)} MB`}),y=m(()=>{if(!l.modelValue)return!1;if(l.modelValue instanceof File)return l.modelValue.type.startsWith("image/");if(typeof l.modelValue=="string"){const r=l.modelValue.toLowerCase();return[".jpg",".jpeg",".png",".gif",".bmp",".webp",".svg"].some(V=>r.includes(V))||r.includes("image")}return!1}),x=r=>{if(!r)return null;if(r.size>l.maxSize)return`Kích thước file không được vượt quá ${l.maxSize/(1024*1024)}MB`;if(l.accept&&l.accept!=="*"){const e=l.accept.split(",").map(f=>f.trim()),s=r.type;if(!e.some(f=>{if(f.endsWith("/*")){const $=f.split("/")[0];return s.startsWith(`${$}/`)}return f===s}))return"Định dạng file không được chấp nhận"}return null},p=()=>{c.value&&c.value.click()},B=r=>{const e=r.target.files[0];if(!e)return;const s=x(e);if(s){u("error",s);return}u("update:modelValue",e),u("error","")},z=r=>{v.value=!1;const e=r.dataTransfer.files[0];if(!e)return;const s=x(e);if(s){u("error",s);return}u("update:modelValue",e),u("error","")},j=()=>{u("update:modelValue",null),c.value&&(c.value.value="")};return(r,e)=>(n(),o("div",N,[t.label?(n(),o("label",{key:0,for:h.value,class:"block text-sm font-medium text-gray-700"},d(t.label),9,E)):g("",!0),a("div",U,[a("div",A,[a("div",{class:b(["rounded-lg overflow-hidden bg-gray-50 border border-gray-200 shadow-sm transition-all duration-200",[t.previewContainerClass,t.error?"border-red-300":"hover:border-blue-300",v.value?"border-blue-500 bg-blue-50 shadow-md":""]]),onDragenter:e[0]||(e[0]=i(s=>v.value=!0,["prevent"])),onDragleave:e[1]||(e[1]=i(s=>v.value=!1,["prevent"])),onDragover:e[2]||(e[2]=i(()=>{},["prevent"])),onDrop:i(z,["prevent"])},[t.modelValue&&y.value?(n(),o("div",K,[a("img",{src:F.value,class:b(["h-full w-full object-center transition duration-200",t.previewType==="cover"?"object-cover":"object-contain"]),alt:t.alt||t.label},null,10,L),a("div",M,[a("button",{type:"button",onClick:i(p,["stop"]),class:"bg-white text-blue-600 p-2 rounded-full shadow-lg border border-blue-200 hover:bg-blue-50 hover:border-blue-300 transition-all duration-200",title:"Thay đổi ảnh"},e[3]||(e[3]=[a("i",{class:"fas fa-edit text-sm"},null,-1)])),a("button",{type:"button",onClick:i(j,["stop"]),class:"bg-white text-red-600 p-2 rounded-full shadow-lg border border-red-200 hover:bg-red-50 hover:border-red-300 transition-all duration-200",title:"Xóa ảnh"},e[4]||(e[4]=[a("i",{class:"fas fa-trash text-sm"},null,-1)]))])])):(n(),o("div",W,[a("div",q,[t.modelValue?(n(),o("div",R,e[5]||(e[5]=[a("i",{class:"fas fa-file-alt text-xl"},null,-1)]))):(n(),o("div",O,[a("i",{class:b(["text-xl",t.icon])},null,2)]))]),t.modelValue&&!y.value?(n(),o("div",X,d(C.value),1)):g("",!0),a("div",G,[t.modelValue?(n(),o(w,{key:0},[a("span",null,d(T.value)+" - ",1),a("span",{class:"text-blue-500 cursor-pointer hover:text-blue-700",onClick:i(p,["stop"])}," Thay đổi ")],64)):(n(),o(w,{key:1},[I(d(t.placeholder||"Kéo thả file hoặc nhấp để chọn"),1)],64))]),t.modelValue?g("",!0):(n(),o("button",{key:1,type:"button",onClick:i(p,["stop"]),class:"mt-1 inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Chọn file "))]))],34)]),a("input",{id:h.value,ref_key:"fileInput",ref:c,type:"file",accept:t.accept,class:"hidden",onChange:B},null,40,H)]),t.error?(n(),o("div",J,d(t.error),1)):g("",!0),t.helpText?(n(),o("div",P,d(t.helpText),1)):g("",!0)]))}},Z=D(Q,[["__scopeId","data-v-0d9658ad"]]);export{Z as B};
