import{_ as M,B as E,u as A,k as i,E as G,G as z,o as I,c as r,a as o,e as t,d as C,q as k,b as R,t as n,f as d,s as V,x as F,v as Q,n as T}from"./index-DjN2xGKQ.js";import{u as U}from"./cv-D9UzxytP.js";import{u as $}from"./useToast-B6sEZtkc.js";const q={class:"min-h-screen bg-gray-50 py-8"},H={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},L={class:"flex items-center mb-6"},P={key:0,class:"space-y-6"},Z={key:1},J={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},O={class:"lg:col-span-2"},W={class:"bg-white shadow rounded-lg p-6"},X={class:"flex justify-between items-center mb-6"},Y={class:"text-xl font-semibold text-gray-900"},tt=["href"],et={class:"border border-gray-200 rounded-lg overflow-hidden"},st={key:0},at=["data"],lt={class:"p-8 bg-gray-100 flex flex-col items-center justify-center h-[750px]"},rt={class:"flex space-x-4"},ot=["href"],nt={key:1,class:"w-full h-96 flex items-center justify-center bg-gray-100"},it={class:"lg:col-span-1"},dt={class:"bg-white shadow rounded-lg p-6 mb-6"},ut={class:"space-y-4"},ct={class:"relative"},vt={class:"pt-2"},ft=["disabled"],mt={key:0,class:"flex items-center"},gt={key:1},xt={class:"mt-6 pt-4 border-t border-gray-200"},pt={class:"flex items-center mb-2"},bt={key:0,class:"mt-2"},yt={class:"mt-1 text-sm text-gray-600 bg-gray-50 p-2 rounded"},ht={class:"bg-white shadow rounded-lg p-6"},wt={class:"space-y-4"},_t={class:"flex items-start"},Ct={class:"text-sm font-medium text-gray-900"},kt={class:"flex items-start"},Vt={class:"text-sm text-gray-900"},Tt={class:"flex items-start"},St={class:"text-sm text-gray-900"},Dt={class:"flex items-start"},jt={class:"text-sm text-gray-900"},Nt={class:"flex items-start"},Bt={class:"text-sm text-gray-900"},Kt={key:2,class:"bg-white shadow rounded-lg p-8 text-center"},Mt={class:"flex"},Et={class:"ml-3"},At={class:"text-sm font-medium text-green-800"},Gt={__name:"CVDetail",setup(zt){const y=E(),x=A(),p=U(),{addToast:v}=$(),b=i(!0),u=i("pending"),c=i(""),f=i(!1),m=i(!1),g=i(!1),h=i(""),s=G(()=>p.currentCV),S=a=>{try{if(!a)return"";const e=new Date(a.replace("+07:00","Z"));return isNaN(e.getTime())?"":new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}catch(e){return console.error("Error formatting date:",e),""}},D=a=>{switch(a){case"pending":return"bg-yellow-100 text-yellow-800";case"not_viewed":return"bg-gray-100 text-gray-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=a=>{switch(a){case"pending":return"Chưa xử lý";case"not_viewed":return"Chưa xem";case"approved":return"Đã tiếp nhận";case"rejected":return"Đã từ chối";default:return"Không xác định"}},N=a=>{h.value=a,m.value=!0,g.value=!1,setTimeout(()=>{g.value=!0,setTimeout(()=>{m.value=!1},300)},5e3)},B=()=>{g.value=!0,setTimeout(()=>{m.value=!1},300)},K=async()=>{try{if(!s.value)return;if(f.value=!0,s.value.status!==u.value||s.value.note!==c.value){const a=await p.updateCVStatus(s.value.id,u.value,c.value);a.success?(N("Cập nhật trạng thái CV thành công"),s.value&&(s.value.status=u.value,s.value.note=c.value)):v({type:"error",message:a.error||"Không thể cập nhật trạng thái CV"})}else v({type:"info",message:"Không có thay đổi để lưu"})}catch(a){console.error("Error saving changes:",a),v({type:"error",message:"Đã xảy ra lỗi khi lưu thay đổi"})}finally{f.value=!1}},w=async()=>{var a,e;try{b.value=!0;const l=y.params.id;if(!l){x.push("/404");return}const _=await p.fetchCVById(l);if(!_.success){v({type:"error",message:_.error||"Không thể lấy thông tin CV"});return}u.value=((a=s.value)==null?void 0:a.status)||"pending",c.value=((e=s.value)==null?void 0:e.note)||""}catch(l){console.error("Error loading CV details:",l),v({type:"error",message:"Đã xảy ra lỗi khi tải thông tin CV"})}finally{b.value=!1}};return z(()=>y.params.id,(a,e)=>{a&&a!==e&&w()}),I(()=>{w()}),(a,e)=>(o(),r("div",q,[t("div",H,[t("div",L,[t("button",{onClick:e[0]||(e[0]=l=>k(x).back()),class:"mr-4 p-2 rounded-full hover:bg-gray-200 transition-colors",title:"Quay lại"},e[4]||(e[4]=[t("i",{class:"fas fa-arrow-left text-gray-600"},null,-1)])),e[5]||(e[5]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Chi tiết CV ứng viên",-1))]),b.value?(o(),r("div",P,e[6]||(e[6]=[R('<div class="grid grid-cols-1 lg:grid-cols-3 gap-6" data-v-7fd67d7f><div class="lg:col-span-2" data-v-7fd67d7f><div class="bg-white shadow rounded-lg p-6" data-v-7fd67d7f><div class="h-8 bg-gray-200 rounded w-1/3 animate-pulse mb-6" data-v-7fd67d7f></div><div class="h-96 bg-gray-200 rounded animate-pulse" data-v-7fd67d7f></div></div></div><div class="lg:col-span-1" data-v-7fd67d7f><div class="bg-white shadow rounded-lg p-6 mb-6" data-v-7fd67d7f><div class="h-6 bg-gray-200 rounded w-1/2 animate-pulse mb-4" data-v-7fd67d7f></div><div class="h-10 bg-gray-200 rounded animate-pulse mb-4" data-v-7fd67d7f></div><div class="h-32 bg-gray-200 rounded animate-pulse" data-v-7fd67d7f></div></div><div class="bg-white shadow rounded-lg p-6" data-v-7fd67d7f><div class="h-6 bg-gray-200 rounded w-1/2 animate-pulse mb-4" data-v-7fd67d7f></div><div class="space-y-2" data-v-7fd67d7f><div class="flex items-center" data-v-7fd67d7f><div class="h-10 w-10 bg-gray-200 rounded-full animate-pulse mr-3" data-v-7fd67d7f></div><div data-v-7fd67d7f><div class="h-4 bg-gray-200 rounded w-24 animate-pulse mb-1" data-v-7fd67d7f></div><div class="h-3 bg-gray-200 rounded w-16 animate-pulse" data-v-7fd67d7f></div></div></div></div></div></div></div>',1)]))):s.value?(o(),r("div",Z,[t("div",J,[t("div",O,[t("div",W,[t("div",X,[t("h2",Y,"CV của "+n(s.value.name),1),t("a",{href:s.value.cv_file_url,download:"",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors"},e[7]||(e[7]=[t("i",{class:"fas fa-download mr-2"},null,-1),d(" Tải xuống ")]),8,tt)]),t("div",et,[s.value.cv_file_url?(o(),r("div",st,[t("object",{data:s.value.cv_file_url,type:"application/pdf",class:"w-full h-screen max-h-[750px]"},[t("div",lt,[e[9]||(e[9]=t("i",{class:"fas fa-file-pdf text-6xl text-red-500 mb-4"},null,-1)),e[10]||(e[10]=t("p",{class:"text-center text-gray-700 mb-4"}," Trình duyệt của bạn không hỗ trợ xem PDF trực tiếp ",-1)),t("div",rt,[t("a",{href:s.value.cv_file_url,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors"},e[8]||(e[8]=[t("i",{class:"fas fa-external-link-alt mr-2"},null,-1),d(" Mở trong tab mới ")]),8,ot)])])],8,at)])):(o(),r("div",nt,e[11]||(e[11]=[t("div",{class:"text-center"},[t("i",{class:"fas fa-file-pdf text-5xl text-gray-400 mb-3"}),t("p",{class:"text-gray-600"},"Không tìm thấy file CV")],-1)])))])])]),t("div",it,[t("div",dt,[e[20]||(e[20]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[t("i",{class:"fas fa-clipboard-check mr-2 text-blue-500"}),d(" Trạng thái CV ")],-1)),t("div",ut,[t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Cập nhật trạng thái ",-1)),t("div",ct,[V(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),class:"block w-full appearance-none border border-gray-300 rounded-md py-3 px-4 pr-8 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"},e[12]||(e[12]=[t("option",{value:"pending"},"Chưa xử lý",-1),t("option",{value:"not_viewed"},"Chưa xem",-1),t("option",{value:"approved"},"Đã tiếp nhận",-1),t("option",{value:"rejected"},"Đã từ chối",-1)]),512),[[F,u.value]]),e[13]||(e[13]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[t("i",{class:"fas fa-chevron-down text-gray-400"})],-1))])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Ghi chú ",-1)),V(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>c.value=l),rows:"4",class:"block w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Ghi chú về ứng viên này..."},null,512),[[Q,c.value]])]),t("div",vt,[t("button",{onClick:K,class:"w-full flex items-center justify-center px-4 py-3 border border-transparent rounded-md shadow-sm text-sm md:text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",disabled:f.value},[f.value?(o(),r("span",mt,e[16]||(e[16]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),d(" Đang lưu... ")]))):(o(),r("span",gt,e[17]||(e[17]=[t("i",{class:"fas fa-save mr-2"},null,-1),d(" Lưu thay đổi ")])))],8,ft)])]),t("div",xt,[t("div",pt,[e[18]||(e[18]=t("span",{class:"text-sm font-medium text-gray-500"},"Trạng thái hiện tại:",-1)),t("span",{class:T(["ml-2 px-2.5 py-1 text-xs font-medium rounded-full",D(s.value.status)])},n(j(s.value.status)),3)]),s.value.note?(o(),r("div",bt,[e[19]||(e[19]=t("span",{class:"text-sm font-medium text-gray-500"},"Ghi chú:",-1)),t("p",yt,n(s.value.note),1)])):C("",!0)])]),t("div",ht,[e[26]||(e[26]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[t("i",{class:"fas fa-user mr-2 text-blue-500"}),d(" Thông tin ứng viên ")],-1)),t("div",wt,[t("div",_t,[e[21]||(e[21]=t("i",{class:"fas fa-user text-gray-400 mt-1 mr-3 w-5"},null,-1)),t("div",null,[t("div",Ct,n(s.value.name),1)])]),t("div",kt,[e[22]||(e[22]=t("i",{class:"fas fa-envelope text-gray-400 mt-1 mr-3 w-5"},null,-1)),t("div",null,[t("div",Vt,n(s.value.email),1)])]),t("div",Tt,[e[23]||(e[23]=t("i",{class:"fas fa-phone text-gray-400 mt-1 mr-3 w-5"},null,-1)),t("div",null,[t("div",St,n(s.value.phone_number),1)])]),t("div",Dt,[e[24]||(e[24]=t("i",{class:"fas fa-calendar text-gray-400 mt-1 mr-3 w-5"},null,-1)),t("div",null,[t("div",jt,"Ngày ứng tuyển: "+n(S(s.value.created_at)),1)])]),t("div",Nt,[e[25]||(e[25]=t("i",{class:"fas fa-briefcase text-gray-400 mt-1 mr-3 w-5"},null,-1)),t("div",null,[t("div",Bt,n(s.value.description),1)])])])])])])])):(o(),r("div",Kt,[e[28]||(e[28]=t("i",{class:"fas fa-exclamation-triangle text-5xl text-yellow-500 mb-4"},null,-1)),e[29]||(e[29]=t("h2",{class:"text-2xl font-medium text-gray-900 mb-2"},"Không tìm thấy thông tin CV",-1)),e[30]||(e[30]=t("p",{class:"text-gray-600 mb-6"},"CV không tồn tại hoặc đã bị xóa",-1)),t("button",{onClick:e[3]||(e[3]=l=>k(x).back()),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors"},e[27]||(e[27]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),d(" Quay lại ")]))]))]),m.value?(o(),r("div",{key:0,class:T(["fixed bottom-4 right-4 bg-green-50 border-l-4 border-green-500 p-4 rounded-md shadow-lg max-w-md transition-all duration-300 ease-in-out transform translate-y-0 opacity-100",{"translate-y-10 opacity-0":g.value}])},[t("div",Mt,[e[32]||(e[32]=t("div",{class:"flex-shrink-0"},[t("i",{class:"fas fa-check-circle text-green-500"})],-1)),t("div",Et,[t("p",At,n(h.value),1)]),t("div",{class:"ml-auto pl-3"},[t("div",{class:"-mx-1.5 -my-1.5"},[t("button",{onClick:B,class:"inline-flex rounded-md p-1.5 text-green-500 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"},e[31]||(e[31]=[t("span",{class:"sr-only"},"Đóng",-1),t("i",{class:"fas fa-times"},null,-1)]))])])])],2)):C("",!0)]))}},Qt=M(Gt,[["__scopeId","data-v-7fd67d7f"]]);export{Qt as default};
