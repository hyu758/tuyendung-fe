import{u as E,k as v,E as R,o as H,r as C,c as l,a,e as t,d as x,t as n,m as V,p as D,b as T,g as h,w as M,f as m,F as K,h as F,n as z,q as I,X as U}from"./index-BAXA5aW0.js";const X={class:"bg-gray-50 min-h-screen"},$={class:"max-w-7xl mx-auto px-4 sm:px-6 py-8"},G={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6"},J={class:"flex items-center"},P={class:"font-medium"},Q={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},W={class:"bg-white rounded-md border border-gray-200 p-4 shadow-sm"},O={class:"text-2xl font-bold text-gray-900 mt-2"},Y={class:"bg-white rounded-md border border-gray-200 p-4 shadow-sm"},Z={class:"text-2xl font-bold text-yellow-600 mt-2"},tt={class:"bg-white rounded-md border border-gray-200 p-4 shadow-sm"},et={class:"text-2xl font-bold text-green-600 mt-2"},st={class:"bg-white rounded-md border border-gray-200 p-4 shadow-sm"},nt={class:"text-2xl font-bold text-red-600 mt-2"},ot={class:"bg-white p-4 mb-6 rounded-md shadow-sm"},rt={class:"flex flex-wrap items-center gap-4"},lt={class:"w-full md:w-auto"},at={class:"bg-white rounded-md shadow-sm"},it={key:0,class:"p-8 text-center"},dt={key:1,class:"p-8 text-center"},ut={class:"mt-6"},mt={key:2},gt={class:"p-4"},ct={class:"flex justify-between items-center mb-4"},vt={class:"space-y-4"},xt={class:"flex items-center justify-between"},pt={class:"flex items-center space-x-4"},ht={class:"flex-shrink-0 w-12 h-12"},yt=["src","alt"],ft={key:1,class:"w-full h-full bg-gray-100 flex items-center justify-center rounded-md text-gray-500"},bt={class:"text-base font-medium text-gray-900"},wt={class:"text-sm text-gray-600"},_t={class:"mt-4 text-sm text-gray-500"},kt={class:"flex items-center justify-between"},jt={class:"flex space-x-2"},Ct=["href"],Vt=["onClick"],Dt={key:1,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 mt-2 rounded-md shadow-sm"},Tt={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Mt={class:"text-sm text-gray-700"},zt={class:"font-medium"},Bt={class:"font-medium"},St={class:"flex items-center justify-center min-h-screen px-4"},Lt={class:"bg-white rounded-lg max-w-2xl w-full p-6 shadow-xl"},Nt={class:"mt-4 space-y-4"},qt={class:"mt-2 border-t border-gray-200 pt-2"},At={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Et={class:"text-sm font-medium"},Rt={class:"text-sm font-medium"},Ht={class:"text-sm font-medium"},Kt={class:"text-sm font-medium"},Ft={class:"mt-2 border-t border-gray-200 pt-2"},It={class:"mb-3"},Ut={class:"text-sm font-medium"},Xt={class:"text-sm font-medium"},$t={class:"mt-2 border-t border-gray-200 pt-2 flex items-center"},Gt={key:0,class:"text-xs text-blue-600"},Jt={key:1,class:"text-xs text-gray-500"},Pt={key:0,class:"mt-2"},Qt={class:"text-sm mt-1 p-2 bg-gray-50 rounded"},Wt={class:"mt-2 border-t border-gray-200 pt-2"},Ot={class:"text-sm whitespace-pre-wrap"},Yt={key:0,class:"mt-4"},Zt=["href"],te={key:3,class:"fixed inset-0 bg-black bg-opacity-50 z-40"},oe={__name:"MyApplications",setup(ee){const B=E(),g=v([]),y=v(!0),b=v(!1),c=v(""),r=v(null),d=v({status:"",dateRange:""}),u=v({total:0,pending:0,approved:0,rejected:0}),S=async()=>{y.value=!0,b.value=!1,c.value="",localStorage.getItem("token");try{const s=await U.getApplications();g.value=s.data.data.results.map(e=>({...e,jobId:e.post})),L()}catch(s){if(console.error("Lỗi khi lấy dữ liệu đơn ứng tuyển:",s),g.value=[],u.value={total:0,pending:0,approved:0,rejected:0},s.value=!0,s.response)switch(s.response.status){case 401:c.value="Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại.";break;case 403:c.value="Bạn không có quyền truy cập danh sách ứng tuyển. Liên hệ quản trị viên.";break;case 404:c.value="Không tìm thấy dữ liệu ứng tuyển.";break;default:c.value=`Lỗi máy chủ: ${s.response.status}. Vui lòng thử lại sau.`}else s.request?c.value="Không thể kết nối đến máy chủ. Vui lòng kiểm tra kết nối mạng.":c.value="Đã xảy ra lỗi khi xử lý yêu cầu."}finally{y.value=!1}},L=()=>{u.value={total:g.value.length,pending:0,approved:0,rejected:0},g.value.forEach(s=>{s.status==="pending"?u.value.pending++:s.status==="approved"?u.value.approved++:s.status==="rejected"&&u.value.rejected++})},w=R(()=>{let s=[...g.value];if(d.value.status&&(s=s.filter(e=>e.status===d.value.status)),d.value.dateRange){const e=new Date;let i;switch(d.value.dateRange){case"last7days":i=new Date(e.setDate(e.getDate()-7));break;case"last30days":i=new Date(e.setDate(e.getDate()-30));break;case"last3months":i=new Date(e.setMonth(e.getMonth()-3));break;case"last6months":i=new Date(e.setMonth(e.getMonth()-6));break}i&&(s=s.filter(p=>new Date(p.created_at)>=i))}return s.sort((e,i)=>new Date(i.created_at)-new Date(e.created_at))}),N=()=>{d.value={status:"",dateRange:""}},_=s=>{const e={year:"numeric",month:"numeric",day:"numeric"};return new Date(s).toLocaleDateString("vi-VN",e)},q=s=>s?s.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"",k=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=s=>{switch(s){case"pending":return"Đang xử lý";case"approved":return"Đã duyệt";case"rejected":return"Từ chối";default:return"Không xác định"}},f=()=>{r.value=null},A=s=>{B.push({name:"candidate-messages",query:{user:s}})};return H(()=>{S()}),(s,e)=>{const i=C("router-link"),p=C("font-awesome-icon");return a(),l("div",X,[t("div",$,[e[39]||(e[39]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"Đơn ứng tuyển của tôi"),t("p",{class:"text-gray-600 mt-1"},"Quản lý tất cả đơn ứng tuyển của bạn")],-1)),b.value?(a(),l("div",G,[t("div",J,[e[2]||(e[2]=t("svg",{class:"h-5 w-5 mr-2 text-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),t("p",P,n(c.value),1)]),e[3]||(e[3]=t("p",{class:"mt-2 text-sm"},"Vui lòng thử đăng nhập lại hoặc liên hệ quản trị viên nếu lỗi vẫn tiếp tục xảy ra.",-1))])):x("",!0),t("div",Q,[t("div",W,[e[4]||(e[4]=t("h3",{class:"text-sm font-medium text-gray-500"},"Tổng đơn ứng tuyển",-1)),t("p",O,n(u.value.total),1)]),t("div",Y,[e[5]||(e[5]=t("h3",{class:"text-sm font-medium text-gray-500"},"Đang xử lý",-1)),t("p",Z,n(u.value.pending),1)]),t("div",tt,[e[6]||(e[6]=t("h3",{class:"text-sm font-medium text-gray-500"},"Đã duyệt",-1)),t("p",et,n(u.value.approved),1)]),t("div",st,[e[7]||(e[7]=t("h3",{class:"text-sm font-medium text-gray-500"},"Từ chối",-1)),t("p",nt,n(u.value.rejected),1)])]),t("div",ot,[t("div",rt,[t("div",lt,[e[9]||(e[9]=t("label",{for:"status-filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Trạng thái",-1)),V(t("select",{id:"status-filter","onUpdate:modelValue":e[0]||(e[0]=o=>d.value.status=o),class:"border border-gray-300 rounded-md p-2 w-full focus:ring-blue-500 focus:border-blue-500"},e[8]||(e[8]=[t("option",{value:""},"Tất cả trạng thái",-1),t("option",{value:"pending"},"Đang xử lý",-1),t("option",{value:"approved"},"Đã duyệt",-1),t("option",{value:"rejected"},"Từ chối",-1)]),512),[[D,d.value.status]])]),t("div",{class:"w-full md:w-auto md:ml-auto mt-2 md:mt-0"},[t("button",{onClick:N,class:"py-2 px-4 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition"}," Đặt lại ")])])]),t("div",at,[y.value?(a(),l("div",it,e[10]||(e[10]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-2 text-gray-600"},"Đang tải dữ liệu...",-1)]))):g.value.length===0?(a(),l("div",dt,[e[12]||(e[12]=T('<div class="mx-auto h-24 w-24 text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><h3 class="mt-2 text-lg font-medium text-gray-900">Không có đơn ứng tuyển</h3><p class="mt-1 text-gray-500">Bạn chưa ứng tuyển công việc nào hoặc không có kết quả phù hợp với bộ lọc.</p>',3)),t("div",ut,[h(i,{to:"/job-search",class:"text-sm font-medium text-blue-600 hover:text-blue-500"},{default:M(()=>e[11]||(e[11]=[m(" Tìm việc ngay "),t("span",{"aria-hidden":"true"},"→",-1)])),_:1})])])):(a(),l("div",mt,[t("div",gt,[t("div",ct,[e[14]||(e[14]=t("h2",{class:"text-lg font-medium text-gray-900"},"Việc làm đã ứng tuyển",-1)),V(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>d.value.status=o),class:"border border-gray-300 rounded-md px-3 py-1 focus:ring-blue-500 focus:border-blue-500"},e[13]||(e[13]=[t("option",{value:""},"Tất cả trạng thái",-1),t("option",{value:"pending"},"Đang xử lý",-1),t("option",{value:"approved"},"Đã duyệt",-1),t("option",{value:"rejected"},"Từ chối",-1)]),512),[[D,d.value.status]])]),t("div",vt,[(a(!0),l(K,null,F(w.value,o=>(a(),l("div",{key:o.id,class:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition"},[t("div",xt,[t("div",pt,[t("div",ht,[o.enterprise_logo?(a(),l("img",{key:0,src:o.enterprise_logo,alt:o.enterprise_name,class:"w-full h-full object-cover rounded-md"},null,8,yt)):(a(),l("div",ft,n(q(o.enterprise_name)),1))]),t("div",null,[t("h3",bt,n(o.post_title),1),t("p",wt,n(o.enterprise_name),1)])]),t("span",{class:z(["px-2 py-1 text-xs rounded-full",k(o.status)])},n(j(o.status)),3)]),t("div",_t,[t("div",kt,[t("div",null,[t("p",null,"Thời gian ứng tuyển: "+n(_(o.created_at)),1)]),t("div",jt,[o.cv_file_url?(a(),l("a",{key:0,href:o.cv_file_url,target:"_blank",class:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},[h(p,{icon:"file-pdf",class:"mr-1"}),e[15]||(e[15]=m(" CV tải lên "))],8,Ct)):x("",!0),t("button",{onClick:se=>A(o.user),class:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},[h(p,{icon:"comment",class:"mr-1"}),e[16]||(e[16]=m(" Nhắn tin "))],8,Vt),h(i,{to:{name:"JobDetail",params:{id:o.post}},class:"inline-flex items-center px-3 py-1 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none"},{default:M(()=>[h(p,{icon:"eye",class:"mr-1"}),e[17]||(e[17]=m(" Xem việc làm "))]),_:2},1032,["to"])])])])]))),128))])])]))]),g.value.length>0?(a(),l("div",Dt,[e[24]||(e[24]=t("div",{class:"flex-1 flex justify-between sm:hidden"},[t("button",{class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Trước "),t("button",{class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Sau ")],-1)),t("div",Tt,[t("div",null,[t("p",Mt,[e[18]||(e[18]=m(" Hiển thị ")),e[19]||(e[19]=t("span",{class:"font-medium"},"1",-1)),e[20]||(e[20]=m(" đến ")),t("span",zt,n(w.value.length),1),e[21]||(e[21]=m(" của ")),t("span",Bt,n(g.value.length),1),e[22]||(e[22]=m(" kết quả "))])]),e[23]||(e[23]=T('<div><nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px"><button class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"><span class="sr-only">Trang trước</span><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></button><button class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-blue-600 hover:bg-blue-50 border-blue-500"> 1 </button><button class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"><span class="sr-only">Trang sau</span><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></nav></div>',1))])])):x("",!0),r.value?(a(),l("div",{key:2,class:"fixed inset-0 overflow-y-auto z-50",onClick:I(f,["self"])},[t("div",St,[t("div",Lt,[t("div",{class:"flex justify-between items-start"},[e[26]||(e[26]=t("h3",{class:"text-xl font-bold text-gray-900"},"Chi tiết đơn ứng tuyển",-1)),t("button",{onClick:f,class:"text-gray-400 hover:text-gray-500"},e[25]||(e[25]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Nt,[t("div",null,[e[31]||(e[31]=t("h4",{class:"text-sm font-medium text-gray-500"},"Thông tin ứng viên",-1)),t("div",qt,[t("div",At,[t("div",null,[e[27]||(e[27]=t("p",{class:"text-sm text-gray-600"},"Họ tên:",-1)),t("p",Et,n(r.value.name),1)]),t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm text-gray-600"},"Email:",-1)),t("p",Rt,n(r.value.email),1)]),t("div",null,[e[29]||(e[29]=t("p",{class:"text-sm text-gray-600"},"Số điện thoại:",-1)),t("p",Ht,n(r.value.phoneNumber),1)]),t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm text-gray-600"},"Ngày ứng tuyển:",-1)),t("p",Kt,n(_(r.value.created_at)),1)])])])]),t("div",null,[e[34]||(e[34]=t("h4",{class:"text-sm font-medium text-gray-500"},"Thông tin công việc",-1)),t("div",Ft,[t("div",It,[e[32]||(e[32]=t("p",{class:"text-sm text-gray-600"},"Vị trí:",-1)),t("p",Ut,n(r.value.post_title),1)]),t("div",null,[e[33]||(e[33]=t("p",{class:"text-sm text-gray-600"},"Công ty:",-1)),t("p",Xt,n(r.value.enterprise_name),1)])])]),t("div",null,[e[36]||(e[36]=t("h4",{class:"text-sm font-medium text-gray-500"},"Trạng thái",-1)),t("div",$t,[t("span",{class:z(["px-2 py-1 inline-flex text-xs leading-5 font-medium rounded-full mr-2",k(r.value.status)])},n(j(r.value.status)),3),r.value.is_viewed?(a(),l("span",Gt," (Đã xem) ")):(a(),l("span",Jt," (Chưa xem) "))]),r.value.note?(a(),l("div",Pt,[e[35]||(e[35]=t("p",{class:"text-sm text-gray-600"},"Ghi chú:",-1)),t("p",Qt,n(r.value.note),1)])):x("",!0)]),t("div",null,[e[37]||(e[37]=t("h4",{class:"text-sm font-medium text-gray-500"},"Nội dung",-1)),t("div",Wt,[t("p",Ot,n(r.value.description),1)])]),r.value.cv_file_url?(a(),l("div",Yt,[t("a",{href:r.value.cv_file_url,target:"_blank",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},e[38]||(e[38]=[t("svg",{class:"h-4 w-4 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),m(" Xem CV đính kèm ")]),8,Zt)])):x("",!0)]),t("div",{class:"mt-6 flex justify-end"},[t("button",{onClick:f,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition"}," Đóng ")])])])])):x("",!0),r.value?(a(),l("div",te)):x("",!0)])])}}};export{oe as default};
