import{_ as I,m as L,j as f,E as V,o as R,r as q,c as d,a as u,e as t,d as A,g,w as x,f as i,t as o,F as D,h as M,n as v}from"./index-D70m-51f.js";import{u as G}from"./post-DM47FKU2.js";const U={class:"job-recommendations-page"},X={class:"container mx-auto px-4 py-8"},Z={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8"},O={class:"bg-white rounded-lg shadow-sm overflow-hidden mb-8"},Q={key:0,class:"flex justify-center items-center py-20"},W={key:1,class:"p-8 text-center"},Y={key:2,class:"p-8 text-center"},j={class:"mt-6 flex flex-col sm:flex-row justify-center gap-4"},ee={key:3},te={class:"p-6 border-b border-gray-200"},se={class:"flex items-center"},re={class:"ml-3 text-lg font-medium text-gray-900"},le={class:"divide-y divide-gray-200"},ne={class:"flex flex-col md:flex-row"},ie={class:"flex-shrink-0 mb-4 md:mb-0"},oe={key:0,class:"h-16 w-16 rounded-md overflow-hidden bg-gray-100"},ae=["src","alt"],de={key:1,class:"h-16 w-16 rounded-md bg-blue-100 flex items-center justify-center text-blue-700 text-xl font-bold"},ue={class:"md:ml-6 flex-1"},me={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start"},ce={class:"text-lg font-medium text-gray-900"},fe={class:"mt-1 text-sm text-gray-500"},ge={class:"mt-2 sm:mt-0 flex flex-wrap items-center gap-2"},xe={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},ve={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},be={class:"mt-2 grid grid-cols-1 sm:grid-cols-3 gap-2"},he={class:"flex items-center text-sm text-gray-500"},ye={class:"flex items-center text-sm text-gray-500"},pe={class:"flex items-center text-sm text-gray-500"},_e={class:"mt-4 flex items-center justify-between"},we={class:"text-sm text-gray-500"},ke={class:"flex space-x-2"},Pe=["onClick"],Ce={class:"px-6 py-4 border-t border-gray-200 flex items-center justify-between"},Ve={class:"flex-1 flex justify-between sm:hidden"},Te=["disabled"],Ne=["disabled"],$e={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},De={class:"text-sm text-gray-700"},Me={class:"font-medium"},Ee={class:"font-medium"},Je={class:"font-medium"},Ke={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Se=["disabled"],Be=["onClick"],ze=["disabled"],Fe={key:0,class:"bg-blue-50 border border-blue-100 rounded-lg p-6"},He={class:"flex"},Ie={class:"ml-4"},Le={class:"mt-1 text-sm text-blue-700"},Re={__name:"JobRecommendations",setup(qe){const m=L(),w=G(),k=f(!0),P=f(!1),h=f([]),l=f(1),y=f(10),b=f(0),c=f(1),E=V(()=>b.value===0?0:(l.value-1)*y.value+1),J=V(()=>{const r=l.value*y.value;return r>b.value?b.value:r}),K=V(()=>{const e=Math.floor(2.5),a=c.value;let s=Math.max(l.value-e,1),n=s+5-1;return n>a&&(n=a,s=Math.max(n-5+1,1)),Array.from({length:n-s+1},(C,_)=>s+_)}),T=r=>{try{if(!r)return"";const e=new Date(r.replace("+07:00","Z"));return isNaN(e.getTime())?"":new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}catch(e){return console.error("Error formatting date:",e),""}},S=r=>{if(!r)return"";const e=new Date(r),s=Math.abs(new Date-e),n=Math.floor(s/(1e3*60*60*24));return n===0?"hôm nay":n===1?"hôm qua":n<7?`${n} ngày trước`:n<30?`${Math.floor(n/7)} tuần trước`:T(r)},B=(r,e,a)=>{if(a)return"Thỏa thuận";const s=n=>n?(n/1e6).toLocaleString("vi-VN"):"";return r&&e?`${s(r)} - ${s(e)} triệu`:r?`Từ ${s(r)} triệu`:e?`Đến ${s(e)} triệu`:"Thỏa thuận"},z=r=>r?r.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"JH",p=async()=>{k.value=!0;try{const r=await w.fetchRecommendedPosts(l.value,y.value);r.success?(h.value=r.data.results||[],b.value=r.data.count||0,c.value=Math.ceil(b.value/y.value)):r.noCriteria?P.value=!0:m.error(r.error||"Không thể lấy việc làm gợi ý. Vui lòng thử lại sau.")}catch(r){console.error("Error fetching recommended jobs:",r),m.error("Có lỗi xảy ra khi tải danh sách việc làm gợi ý.")}finally{k.value=!1}},F=async r=>{try{if(r.is_saved){const e=await w.deleteSavedPostByPostId(r.id);e.success?(m.success("Đã bỏ lưu bài đăng"),r.is_saved=!1):m.error(e.error||"Không thể bỏ lưu bài đăng.")}else{const e=await w.savePost(r.id);e.success?(m.success("Đã lưu bài đăng"),r.is_saved=!0):m.error(e.error||"Không thể lưu bài đăng.")}}catch(e){console.error("Error toggling saved status:",e),m.error("Không thể thực hiện thao tác. Vui lòng thử lại sau.")}},H=r=>{r!==l.value&&(l.value=r,p())},N=()=>{l.value>1&&(l.value--,p())},$=()=>{l.value<c.value&&(l.value++,p())};return R(()=>{p()}),(r,e)=>{const a=q("router-link");return u(),d("div",U,[t("div",X,[t("div",Z,[e[1]||(e[1]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Việc làm phù hợp với bạn"),t("p",{class:"text-gray-600 mt-1"},"Gợi ý dựa trên tiêu chí tìm việc của bạn")],-1)),g(a,{to:"/my-criteria",class:"mt-4 md:mt-0 inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:x(()=>e[0]||(e[0]=[t("i",{class:"fas fa-sliders-h mr-2"},null,-1),i(" Chỉnh sửa tiêu chí ")])),_:1})]),t("div",O,[k.value?(u(),d("div",Q,e[2]||(e[2]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):P.value?(u(),d("div",W,[e[4]||(e[4]=t("div",{class:"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-blue-100 text-blue-500 mb-4"},[t("i",{class:"fas fa-filter text-3xl"})],-1)),e[5]||(e[5]=t("h3",{class:"text-lg font-medium text-gray-900"},"Chưa có tiêu chí tìm việc",-1)),e[6]||(e[6]=t("p",{class:"mt-2 text-gray-500 max-w-md mx-auto"}," Bạn cần thiết lập tiêu chí tìm việc để nhận được gợi ý việc làm phù hợp với mong muốn của mình. ",-1)),g(a,{to:"/my-criteria",class:"mt-6 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:x(()=>e[3]||(e[3]=[t("i",{class:"fas fa-plus-circle mr-2"},null,-1),i(" Tạo tiêu chí tìm việc ")])),_:1})])):h.value.length===0?(u(),d("div",Y,[e[9]||(e[9]=t("div",{class:"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-yellow-100 text-yellow-500 mb-4"},[t("i",{class:"fas fa-search text-3xl"})],-1)),e[10]||(e[10]=t("h3",{class:"text-lg font-medium text-gray-900"},"Không tìm thấy việc làm phù hợp",-1)),e[11]||(e[11]=t("p",{class:"mt-2 text-gray-500 max-w-md mx-auto"}," Không có việc làm nào phù hợp với tiêu chí của bạn. Hãy thử điều chỉnh tiêu chí hoặc quay lại sau. ",-1)),t("div",j,[g(a,{to:"/my-criteria",class:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:x(()=>e[7]||(e[7]=[t("i",{class:"fas fa-edit mr-2"},null,-1),i(" Điều chỉnh tiêu chí ")])),_:1}),g(a,{to:"/job-search",class:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:x(()=>e[8]||(e[8]=[t("i",{class:"fas fa-search mr-2"},null,-1),i(" Tìm kiếm việc làm ")])),_:1})])])):(u(),d("div",ee,[t("div",te,[t("div",se,[e[12]||(e[12]=t("span",{class:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center"},[t("i",{class:"fas fa-thumbs-up text-blue-500"})],-1)),t("h3",re,o(h.value.length)+" việc làm phù hợp với tiêu chí của bạn ",1)])]),t("div",le,[(u(!0),d(D,null,M(h.value,s=>{var n,C,_;return u(),d("div",{key:s.id,class:"p-6 hover:bg-gray-50 transition-colors"},[t("div",ne,[t("div",ie,[(n=s.enterprise)!=null&&n.logo?(u(),d("div",oe,[t("img",{src:s.enterprise.logo,alt:s.enterprise.name,class:"h-full w-full object-contain"},null,8,ae)])):(u(),d("div",de,o(z((C=s.enterprise)==null?void 0:C.name)),1))]),t("div",ue,[t("div",me,[t("div",null,[t("h3",ce,[g(a,{to:`/jobs/${s.id}`,class:"hover:text-blue-600"},{default:x(()=>[i(o(s.title),1)]),_:2},1032,["to"])]),t("p",fe,o((_=s.enterprise)==null?void 0:_.name),1)]),t("div",ge,[t("span",xe,[e[13]||(e[13]=t("i",{class:"fas fa-map-marker-alt mr-1"},null,-1)),i(" "+o(s.city),1)]),t("span",ve,[e[14]||(e[14]=t("i",{class:"fas fa-briefcase mr-1"},null,-1)),i(" "+o(s.type_working),1)])])]),t("div",be,[t("div",he,[e[15]||(e[15]=t("i",{class:"fas fa-money-bill-wave mr-1 text-gray-400"},null,-1)),t("span",null,o(B(s.salary_min,s.salary_max,s.is_salary_negotiable)),1)]),t("div",ye,[e[16]||(e[16]=t("i",{class:"fas fa-user-graduate mr-1 text-gray-400"},null,-1)),t("span",null,o(s.experience),1)]),t("div",pe,[e[17]||(e[17]=t("i",{class:"fas fa-clock mr-1 text-gray-400"},null,-1)),t("span",null,"Hạn: "+o(T(s.deadline)),1)])]),t("div",_e,[t("div",we,[e[18]||(e[18]=t("i",{class:"fas fa-calendar-alt mr-1"},null,-1)),i(" Đăng "+o(S(s.created_at)),1)]),t("div",ke,[t("button",{onClick:Ae=>F(s),class:v(["inline-flex items-center px-3 py-1 border rounded-md text-sm font-medium",s.is_saved?"border-red-300 text-red-700 bg-red-50 hover:bg-red-100":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50"])},[t("i",{class:v(["mr-1.5",s.is_saved?"fas fa-heart text-red-500":"far fa-heart"])},null,2),i(" "+o(s.is_saved?"Đã lưu":"Lưu"),1)],10,Pe),g(a,{to:`/jobs/${s.id}`,class:"inline-flex items-center px-3 py-1 border border-transparent rounded-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700"},{default:x(()=>e[19]||(e[19]=[i(" Xem chi tiết ")])),_:2},1032,["to"])])])])])])}),128))]),t("div",Ce,[t("div",Ve,[t("button",{onClick:N,disabled:l.value===1,class:v([{"opacity-50 cursor-not-allowed":l.value===1},"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"])}," Trước ",10,Te),t("button",{onClick:$,disabled:l.value===c.value,class:v([{"opacity-50 cursor-not-allowed":l.value===c.value},"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"])}," Sau ",10,Ne)]),t("div",$e,[t("div",null,[t("p",De,[e[20]||(e[20]=i(" Hiển thị ")),t("span",Me,o(E.value),1),e[21]||(e[21]=i(" đến ")),t("span",Ee,o(J.value),1),e[22]||(e[22]=i(" của ")),t("span",Je,o(b.value),1),e[23]||(e[23]=i(" kết quả "))])]),t("div",null,[t("nav",Ke,[t("button",{onClick:N,disabled:l.value===1,class:v([{"opacity-50 cursor-not-allowed":l.value===1},"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"])},e[24]||(e[24]=[t("span",{class:"sr-only"},"Previous",-1),t("i",{class:"fas fa-chevron-left text-xs"},null,-1)]),10,Se),(u(!0),d(D,null,M(K.value,s=>(u(),d("button",{key:s,onClick:n=>H(s),class:v([{"z-10 bg-blue-50 border-blue-500 text-blue-600":l.value===s,"bg-white border-gray-300 text-gray-500 hover:bg-gray-50":l.value!==s},"relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},o(s),11,Be))),128)),t("button",{onClick:$,disabled:l.value===c.value,class:v([{"opacity-50 cursor-not-allowed":l.value===c.value},"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"])},e[25]||(e[25]=[t("span",{class:"sr-only"},"Next",-1),t("i",{class:"fas fa-chevron-right text-xs"},null,-1)]),10,ze)])])])])]))]),!P.value&&h.value.length>0?(u(),d("div",Fe,[t("div",He,[e[30]||(e[30]=t("div",{class:"flex-shrink-0"},[t("i",{class:"fas fa-lightbulb text-blue-400 text-xl"})],-1)),t("div",Ie,[e[29]||(e[29]=t("h4",{class:"text-base font-medium text-blue-800"},"Nhận thêm gợi ý phù hợp hơn",-1)),t("p",Le,[e[27]||(e[27]=i(" Việc làm được gợi ý dựa trên tiêu chí tìm việc của bạn. ")),g(a,{to:"/my-criteria",class:"font-medium underline hover:text-blue-900"},{default:x(()=>e[26]||(e[26]=[i("Cập nhật tiêu chí")])),_:1}),e[28]||(e[28]=i(" để nhận gợi ý phù hợp hơn với mong muốn của bạn. "))])])])])):A("",!0)])])}}},Xe=I(Re,[["__scopeId","data-v-f58b86db"]]);export{Xe as default};
