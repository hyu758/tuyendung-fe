import{h as V,j as m,r as v,c,o as n,d as s,s as f,b as y,z as x,l as h,q as C,f as l,w as E,e as S,C as $}from"./index-Bw2aqbXG.js";import{_ as N}from"./BaseInput-BeSzWnre.js";import{_ as k}from"./BaseButton-BVQ0sqiB.js";import{s as z,a as g}from"./notifications-BdlxHN63.js";const B={class:"bg-gray-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8"},q={class:"max-w-md mx-auto"},A={class:"bg-white py-8 px-6 shadow rounded-lg"},K={class:"space-y-6"},Q={key:3,class:"text-center"},L={class:"mt-6 text-center"},M={class:"text-sm text-gray-600"},P={__name:"ForgotPassword",setup(Z){const t=V(),r=m(""),u=m({}),o=m(""),i=m(!1),_=async()=>{u.value={};let a=!0;if(r.value?b(r.value)||(u.value.email="Email không hợp lệ",a=!1):(u.value.email="Email không được để trống",a=!1),!!a){i.value=!0,t.error=null;try{const e=await $.post("/api/forgot-password/",{email:r.value});console.log(e),e.status===200?(o.value="Email hướng dẫn đặt lại mật khẩu đã được gửi.",z("Email hướng dẫn đặt lại mật khẩu đã được gửi thành công.")):(t.error=e.data.error||"Có lỗi xảy ra khi gửi yêu cầu. Vui lòng thử lại.",g(t.error))}catch(e){console.error("Lỗi quên mật khẩu:",e),e.response?(t.error=e.response.data.error||"Có lỗi xảy ra khi gửi yêu cầu. Vui lòng thử lại.",g("Không thể gửi email đặt lại mật khẩu. Vui lòng thử lại sau.")):(t.error="Không thể kết nối đến máy chủ. Vui lòng thử lại sau.",g("Không thể kết nối đến máy chủ. Vui lòng thử lại sau."))}finally{i.value=!1}}},b=a=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(a).toLowerCase());return(a,e)=>{const d=v("font-awesome-icon"),w=v("router-link");return n(),c("div",B,[s("div",q,[e[4]||(e[4]=s("div",{class:"text-center mb-8"},[s("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Quên mật khẩu"),s("p",{class:"text-gray-600"},"Nhập email của bạn để đặt lại mật khẩu")],-1)),s("div",A,[o.value?(n(),f(x,{key:0,variant:"success",message:o.value,show:!!o.value,class:"mb-6"},null,8,["message","show"])):y("",!0),h(t).error?(n(),f(x,{key:1,variant:"error",message:h(t).error,show:!!h(t).error,class:"mb-6"},null,8,["message","show"])):y("",!0),o.value?(n(),c("div",Q,[l(d,{icon:"check-circle",class:"text-green-500 text-5xl mb-4"}),e[2]||(e[2]=s("p",{class:"text-gray-700 mb-6"},"Chúng tôi đã gửi email hướng dẫn đặt lại mật khẩu. Vui lòng kiểm tra hộp thư của bạn.",-1)),l(k,{variant:"primary",label:"Quay lại đăng nhập",onClick:e[1]||(e[1]=p=>a.$router.push("/login")),class:"w-full"})])):(n(),c("form",{key:2,onSubmit:C(_,["prevent"])},[s("div",K,[l(N,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=p=>r.value=p),type:"email",label:"Email",placeholder:"Email đã đăng ký",autocomplete:"email",required:"",prefixIcon:"envelope",error:u.value.email},null,8,["modelValue","error"]),s("div",null,[l(k,{type:"submit",variant:"primary",size:"lg",label:i.value?"Đang gửi yêu cầu...":"Gửi yêu cầu đặt lại mật khẩu",loading:i.value,disabled:i.value,class:"w-full"},null,8,["label","loading","disabled"])])])],32))]),s("div",L,[s("p",M,[l(w,{to:"/login",class:"font-medium text-blue-600 hover:text-blue-500"},{default:E(()=>[l(d,{icon:"arrow-left",class:"mr-1"}),e[3]||(e[3]=S(" Quay lại đăng nhập "))]),_:1})])])])])}}};export{P as default};
