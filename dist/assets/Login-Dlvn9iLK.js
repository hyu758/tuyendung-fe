import{u as w,i as k,y as _,k as c,o as V,r as C,c as A,a as h,e as r,s as M,d as R,l as n,z as G,q as N,g as i,m as S,A as U,w as v,f as g,b as B}from"./index-Bv67TR0K.js";import{_ as f}from"./BaseInput-DwvSMeLF.js";import{_ as b}from"./BaseButton-q4KYHRx3.js";const L={class:"bg-gray-50 min-h-screen py-12 px-4 sm:px-6 lg:px-8"},T={class:"max-w-md mx-auto"},$={class:"bg-white py-8 px-6 shadow rounded-lg"},j={class:"space-y-6"},q={class:"flex items-center justify-between"},z={class:"flex items-center"},D={class:"text-sm"},E={class:"mt-6"},H={class:"mt-6"},I={class:"mt-6 text-center"},P={class:"text-sm text-gray-600"},F={__name:"Login",setup(J){const m=w(),s=k();_(()=>{});const u=c(""),d=c(""),p=c(!1),t=c({});V(()=>{s.error=null,s.isAuthenticated&&(s.userRole==="admin"?m.push("/admin/dashboard"):s.userRole==="employer"?m.push("/employer/dashboard"):s.userRole==="none"&&m.push("/select-role"))});const x=async()=>{t.value={},s.error=null;let a=!0;if(u.value||(t.value.username="Tên đăng nhập không được để trống",a=!1),d.value||(t.value.password="Mật khẩu không được để trống",a=!1),!!a)try{const e=await s.login({email:u.value,password:d.value,remember:p.value});!(e!=null&&e.success)&&(e!=null&&e.errors)&&(console.log("Received errors from backend:",e.errors),Object.keys(e.errors).forEach(o=>{Array.isArray(e.errors[o])?t.value[o]=e.errors[o][0]:t.value[o]=e.errors[o]}),e.errors.account&&(s.error=Array.isArray(e.errors.account)?e.errors.account[0]:e.errors.account))}catch(e){console.error("Lỗi khi đăng nhập:",e),s.error="Có lỗi xảy ra khi đăng nhập. Vui lòng thử lại sau."}},y=()=>{try{const e="https://api.tuyendungtlu.site";window.location.href=e+"/api/auth/login/google-oauth2/"}catch(a){console.error("Lỗi khi bắt đầu đăng nhập với Google:",a),s.error="Có lỗi xảy ra khi bắt đầu đăng nhập Google"}};return(a,e)=>{const o=C("router-link");return h(),A("div",L,[r("div",T,[e[9]||(e[9]=r("div",{class:"text-center mb-8"},[r("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Đăng nhập"),r("p",{class:"text-gray-600"},"Đăng nhập để tiếp tục với JobHub")],-1)),r("div",$,[n(s).error?(h(),M(G,{key:0,variant:"error",message:n(s).error,show:!!n(s).error,dismissible:"",onDismiss:e[0]||(e[0]=l=>n(s).error=null),class:"mb-6"},null,8,["message","show"])):R("",!0),r("form",{onSubmit:N(x,["prevent"])},[r("div",j,[i(f,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),type:"text",label:"Tên đăng nhập",placeholder:"Tên đăng nhập của bạn",autocomplete:"username",required:"",prefixIcon:"user",error:t.value.username,class:"transform transition-all duration-200 focus-within:scale-105"},null,8,["modelValue","error"]),i(f,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value=l),type:"password",label:"Mật khẩu",placeholder:"Mật khẩu của bạn",autocomplete:"current-password",required:"",prefixIcon:"lock",error:t.value.password,class:"transform transition-all duration-200 focus-within:scale-105"},null,8,["modelValue","error"]),r("div",q,[r("div",z,[S(r("input",{id:"remember_me",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=l=>p.value=l),class:"h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded transition-all"},null,512),[[U,p.value]]),e[4]||(e[4]=r("label",{for:"remember_me",class:"ml-2 block text-sm text-gray-700"}," Ghi nhớ đăng nhập ",-1))]),r("div",D,[i(o,{to:"/forgot-password",class:"font-medium text-blue-600 hover:text-blue-800 transition-colors"},{default:v(()=>e[5]||(e[5]=[g(" Quên mật khẩu? ")])),_:1})])]),r("div",null,[i(b,{type:"submit",variant:"primary",size:"lg",label:"Đăng nhập",loading:n(s).loading,disabled:n(s).loading,class:"w-full transform transition-all duration-300 hover:shadow-lg hover:scale-105 rounded-lg py-4 text-lg font-bold"},null,8,["loading","disabled"])])])],32),r("div",E,[e[6]||(e[6]=B('<div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500">Hoặc đăng nhập với</span></div></div>',1)),r("div",H,[i(b,{variant:"light",class:"w-full",icon:["fab","google"],label:"Google",onClick:y})])])]),r("div",I,[r("p",P,[e[8]||(e[8]=g(" Chưa có tài khoản? ")),i(o,{to:"/register",class:"font-medium text-blue-600 hover:text-blue-500"},{default:v(()=>e[7]||(e[7]=[g(" Đăng ký ngay ")])),_:1})])])])])}}};export{F as default};
