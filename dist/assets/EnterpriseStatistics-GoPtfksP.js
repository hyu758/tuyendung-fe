import{_ as f,k as g,o as y,G as w,c as r,a as c,r as u,g as m,e as t,t as a,f as h,d as b,F as k,h as C,w as S,x as T,E as v}from"./index-42FtppBQ.js";import{C as P,P as E}from"./auto-ChrlGaVn.js";const A={name:"MonthlyStatsChart",props:{data:{type:Array,required:!0,default:()=>[]}},setup(n){const s=g(null);let l=null;const e=()=>{if(!s.value||!n.data||n.data.length===0)return;const p=n.data.map(i=>i.month),x=n.data.map(i=>i.applicants),_=n.data.map(i=>i.posts),d=s.value.getContext("2d");l&&l.destroy(),l=new P(d,{type:"bar",data:{labels:p,datasets:[{label:"Số ứng viên",data:x,backgroundColor:"rgba(59, 130, 246, 0.5)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"Số tin đăng",data:_,backgroundColor:"rgba(99, 102, 241, 0.5)",borderColor:"rgba(99, 102, 241, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{precision:0}}},plugins:{legend:{position:"top"},title:{display:!1},tooltip:{callbacks:{title:function(i){return i[0].label},label:function(i){let o=i.dataset.label||"";return o&&(o+=": "),o+=i.parsed.y,o}}}}}})};return y(()=>{e()}),w(()=>n.data,()=>{e()},{deep:!0}),{chartContainer:s}}},M={class:"w-full h-full",ref:"chartContainer"};function V(n,s,l,e,p,x){return c(),r("div",M,null,512)}const F=f(A,[["render",V]]),H={name:"EnterpriseStatistics",components:{PageHeader:E,MonthlyStatsChart:F},setup(){const n=T(),s=g(!0),l=g(null),e=g({total_posts:0,active_posts:0,expired_posts:0,total_applicants:0,pending_applicants:0,approved_applicants:0,rejected_applicants:0,total_interviews:0,upcoming_interviews:0,completed_interviews:0,monthly_stats:[],post_stats:[]}),p=v(()=>e.value.total_posts),x=v(()=>e.value.total_applicants),_=async()=>{s.value=!0,l.value=null;try{const d=await n.getEnterpriseStatistics();d.success?e.value=d.data:l.value=d.error}catch(d){l.value="Không thể tải dữ liệu thống kê. Vui lòng thử lại sau.",console.error("Failed to fetch statistics:",d)}finally{s.value=!1}};return y(()=>{_()}),{loading:s,error:l,statistics:e,statisticsTotalPosts:p,statisticsTotalApplicants:x}}},N={class:"bg-gray-50 min-h-screen"},j={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},B={key:0,class:"flex justify-center items-center h-64"},W={key:1,class:"bg-red-50 border border-red-200 p-4 rounded-md"},q={class:"flex"},D={class:"ml-3"},G={class:"mt-2 text-sm text-red-700"},K={key:2,class:"space-y-8"},L={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},R={class:"bg-white overflow-hidden shadow rounded-lg"},X={class:"p-5"},Z={class:"flex items-center"},z={class:"ml-5 w-0 flex-1"},I={class:"text-lg font-semibold text-gray-900"},J={class:"text-xs text-gray-500"},O={class:"text-green-600"},Q={class:"text-red-600"},U={class:"bg-white overflow-hidden shadow rounded-lg"},Y={class:"p-5"},$={class:"flex items-center"},tt={class:"ml-5 w-0 flex-1"},st={class:"text-lg font-semibold text-gray-900"},et={class:"text-xs text-gray-500"},at={class:"text-yellow-600"},it={class:"text-green-600"},ot={class:"bg-white overflow-hidden shadow rounded-lg"},nt={class:"p-5"},lt={class:"flex items-center"},dt={class:"ml-5 w-0 flex-1"},rt={class:"text-lg font-semibold text-gray-900"},ct={class:"text-xs text-gray-500"},pt={class:"text-blue-600"},xt={class:"text-green-600"},_t={class:"bg-white overflow-hidden shadow rounded-lg"},ht={class:"p-5"},gt={class:"flex items-center"},ut={class:"ml-5 w-0 flex-1"},mt={class:"text-lg font-semibold text-gray-900"},vt={class:"bg-white shadow rounded-lg p-6"},ft={class:"h-80"},yt={class:"bg-white shadow rounded-lg overflow-hidden"},wt={class:"overflow-x-auto"},bt={class:"min-w-full divide-y divide-gray-200"},kt={class:"bg-white divide-y divide-gray-200"},Ct={class:"px-6 py-4 whitespace-nowrap"},St={class:"text-sm font-medium text-gray-900"},Tt={class:"px-6 py-4 whitespace-nowrap text-center"},Pt={class:"text-sm text-gray-900"},Et={class:"px-6 py-4 whitespace-nowrap text-center"},At={class:"text-sm text-yellow-600"},Mt={class:"px-6 py-4 whitespace-nowrap text-center"},Vt={class:"text-sm text-green-600"},Ft={class:"px-6 py-4 whitespace-nowrap text-center"},Ht={class:"text-sm text-red-600"},Nt={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},jt={key:0};function Bt(n,s,l,e,p,x){const _=u("PageHeader"),d=u("MonthlyStatsChart"),i=u("router-link");return c(),r("div",N,[m(_,{title:"Thống kê doanh nghiệp"}),t("div",j,[e.loading?(c(),r("div",B,s[0]||(s[0]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"},null,-1)]))):e.error?(c(),r("div",W,[t("div",q,[s[2]||(s[2]=t("div",{class:"flex-shrink-0"},[t("i",{class:"fas fa-exclamation-circle text-red-500 text-lg"})],-1)),t("div",D,[s[1]||(s[1]=t("h3",{class:"text-sm font-medium text-red-800"},"Có lỗi xảy ra khi tải dữ liệu",-1)),t("div",G,a(e.error),1)])])])):(c(),r("div",K,[t("div",L,[t("div",R,[t("div",X,[t("div",Z,[s[5]||(s[5]=t("div",{class:"flex-shrink-0 bg-indigo-500 rounded-md p-3"},[t("i",{class:"fas fa-briefcase text-white"})],-1)),t("div",z,[t("dl",null,[s[4]||(s[4]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Tin tuyển dụng",-1)),t("dd",null,[t("div",I,a(e.statistics.total_posts),1),t("div",J,[t("span",O,a(e.statistics.active_posts)+" hoạt động",1),s[3]||(s[3]=h(", ")),t("span",Q,a(e.statistics.expired_posts)+" hết hạn",1)])])])])])])]),t("div",U,[t("div",Y,[t("div",$,[s[8]||(s[8]=t("div",{class:"flex-shrink-0 bg-blue-500 rounded-md p-3"},[t("i",{class:"fas fa-user-tie text-white"})],-1)),t("div",tt,[t("dl",null,[s[7]||(s[7]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Ứng viên",-1)),t("dd",null,[t("div",st,a(e.statistics.total_applicants),1),t("div",et,[t("span",at,a(e.statistics.pending_applicants)+" chờ xử lý",1),s[6]||(s[6]=h(", ")),t("span",it,a(e.statistics.approved_applicants)+" đã duyệt",1)])])])])])])]),t("div",ot,[t("div",nt,[t("div",lt,[s[11]||(s[11]=t("div",{class:"flex-shrink-0 bg-purple-500 rounded-md p-3"},[t("i",{class:"fas fa-comments text-white"})],-1)),t("div",dt,[t("dl",null,[s[10]||(s[10]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Phỏng vấn",-1)),t("dd",null,[t("div",rt,a(e.statistics.total_interviews),1),t("div",ct,[t("span",pt,a(e.statistics.upcoming_interviews)+" sắp diễn ra",1),s[9]||(s[9]=h(", ")),t("span",xt,a(e.statistics.completed_interviews)+" đã hoàn thành",1)])])])])])])]),t("div",_t,[t("div",ht,[t("div",gt,[s[14]||(s[14]=t("div",{class:"flex-shrink-0 bg-green-500 rounded-md p-3"},[t("i",{class:"fas fa-chart-line text-white"})],-1)),t("div",ut,[t("dl",null,[s[13]||(s[13]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Tỷ lệ chuyển đổi",-1)),t("dd",null,[t("div",mt,a(e.statisticsTotalPosts>0?(e.statisticsTotalApplicants/e.statisticsTotalPosts).toFixed(1):0),1),s[12]||(s[12]=t("div",{class:"text-xs text-gray-500"},"Ứng viên/tin đăng",-1))])])])])])])]),t("div",vt,[s[15]||(s[15]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Thống kê theo tháng",-1)),t("div",ft,[m(d,{data:e.statistics.monthly_stats},null,8,["data"])])]),t("div",yt,[s[19]||(s[19]=t("div",{class:"px-6 py-5 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Thống kê theo tin tuyển dụng"),t("p",{class:"mt-1 text-sm text-gray-500"},"10 tin tuyển dụng gần nhất của doanh nghiệp.")],-1)),t("div",wt,[t("table",bt,[s[18]||(s[18]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tiêu đề "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tổng ứng viên "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Chờ xử lý "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Đã duyệt "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Đã từ chối "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Hành động ")])],-1)),t("tbody",kt,[(c(!0),r(k,null,C(e.statistics.post_stats,o=>(c(),r("tr",{key:o.id},[t("td",Ct,[t("div",St,a(o.title),1)]),t("td",Tt,[t("div",Pt,a(o.total_applicants),1)]),t("td",Et,[t("div",At,a(o.pending_applicants),1)]),t("td",Mt,[t("div",Vt,a(o.approved_applicants),1)]),t("td",Ft,[t("div",Ht,a(o.rejected_applicants),1)]),t("td",Nt,[m(i,{to:`/posts/${o.id}`,class:"text-blue-600 hover:text-blue-900"},{default:S(()=>s[16]||(s[16]=[h(" Xem chi tiết ")])),_:2},1032,["to"])])]))),128)),e.statistics.post_stats.length===0?(c(),r("tr",jt,s[17]||(s[17]=[t("td",{colspan:"6",class:"px-6 py-4 text-center text-sm text-gray-500"}," Chưa có tin tuyển dụng nào ",-1)]))):b("",!0)])])])])]))])])}const Dt=f(H,[["render",Bt]]);export{Dt as default};
