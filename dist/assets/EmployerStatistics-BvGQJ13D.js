import{_ as f,j as g,o as w,P as v,G as b,c as d,a as r,e as t,r as u,g as m,t as i,f as h,d as k,F as C,h as T,w as S,y as P,E as y}from"./index-B8AWlpIq.js";import{C as E,P as A}from"./auto-F4yrfz91.js";const M={name:"MonthlyStatsChart",props:{data:{type:Array,required:!0,default:()=>[]}},setup(n){const s=g(null);let l=null;const e=async()=>{if(!s.value||!n.data||n.data.length===0)return;await v();const p=n.data.map(a=>a.month),x=n.data.map(a=>a.applicants),_=n.data.map(a=>a.posts);try{const a=s.value.getContext("2d");l&&l.destroy(),l=new E(a,{type:"bar",data:{labels:p,datasets:[{label:"Số ứng viên",data:x,backgroundColor:"rgba(59, 130, 246, 0.5)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"Số tin đăng",data:_,backgroundColor:"rgba(99, 102, 241, 0.5)",borderColor:"rgba(99, 102, 241, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{precision:0}}},plugins:{legend:{position:"top"},title:{display:!1},tooltip:{callbacks:{title:function(c){return c[0].label},label:function(c){let o=c.dataset.label||"";return o&&(o+=": "),o+=c.parsed.y,o}}}}}})}catch(a){console.error("Lỗi khi tạo biểu đồ:",a)}};return w(async()=>{await v(),e()}),b(()=>n.data,()=>{e()},{deep:!0}),{chartContainer:s}}},V={class:"w-full h-full"},j={ref:"chartContainer"};function F(n,s,l,e,p,x){return r(),d("div",V,[t("canvas",j,null,512)])}const H=f(M,[["render",F]]),N={name:"EmployerStatistics",components:{PageHeader:A,MonthlyStatsChart:H},setup(){const n=P(),s=g(!0),l=g(null),e=g({total_posts:0,active_posts:0,expired_posts:0,total_applicants:0,pending_applicants:0,approved_applicants:0,rejected_applicants:0,total_interviews:0,upcoming_interviews:0,completed_interviews:0,monthly_stats:[],post_stats:[]}),p=y(()=>e.value.total_posts),x=y(()=>e.value.total_applicants),_=async()=>{s.value=!0,l.value=null;try{const a=await n.getEmployerStatistics();a.success?e.value=a.data:l.value=a.error}catch(a){l.value="Không thể tải dữ liệu thống kê. Vui lòng thử lại sau.",console.error("Failed to fetch statistics:",a)}finally{s.value=!1}};return w(()=>{_()}),{loading:s,error:l,statistics:e,statisticsTotalPosts:p,statisticsTotalApplicants:x}}},B={class:"bg-gray-50 min-h-screen"},q={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},L={key:0,class:"flex justify-center items-center h-64"},W={key:1,class:"bg-red-50 border border-red-200 p-4 rounded-md"},D={class:"flex"},G={class:"ml-3"},K={class:"mt-2 text-sm text-red-700"},R={key:2,class:"space-y-8"},X={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Z={class:"bg-white overflow-hidden shadow rounded-lg"},z={class:"p-5"},I={class:"flex items-center"},J={class:"ml-5 w-0 flex-1"},O={class:"text-lg font-semibold text-gray-900"},Q={class:"text-xs text-gray-500"},U={class:"text-green-600"},Y={class:"text-red-600"},$={class:"bg-white overflow-hidden shadow rounded-lg"},tt={class:"p-5"},st={class:"flex items-center"},et={class:"ml-5 w-0 flex-1"},at={class:"text-lg font-semibold text-gray-900"},it={class:"text-xs text-gray-500"},ot={class:"text-yellow-600"},nt={class:"text-green-600"},lt={class:"bg-white overflow-hidden shadow rounded-lg"},dt={class:"p-5"},rt={class:"flex items-center"},ct={class:"ml-5 w-0 flex-1"},pt={class:"text-lg font-semibold text-gray-900"},xt={class:"text-xs text-gray-500"},_t={class:"text-blue-600"},ht={class:"text-green-600"},gt={class:"bg-white overflow-hidden shadow rounded-lg"},ut={class:"p-5"},mt={class:"flex items-center"},vt={class:"ml-5 w-0 flex-1"},yt={class:"text-lg font-semibold text-gray-900"},ft={class:"bg-white shadow rounded-lg p-6"},wt={class:"h-80"},bt={class:"bg-white shadow rounded-lg overflow-hidden"},kt={class:"overflow-x-auto"},Ct={class:"min-w-full divide-y divide-gray-200"},Tt={class:"bg-white divide-y divide-gray-200"},St={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"text-sm font-medium text-gray-900"},Et={class:"px-6 py-4 whitespace-nowrap text-center"},At={class:"text-sm text-gray-900"},Mt={class:"px-6 py-4 whitespace-nowrap text-center"},Vt={class:"text-sm text-yellow-600"},jt={class:"px-6 py-4 whitespace-nowrap text-center"},Ft={class:"text-sm text-green-600"},Ht={class:"px-6 py-4 whitespace-nowrap text-center"},Nt={class:"text-sm text-red-600"},Bt={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},qt={key:0};function Lt(n,s,l,e,p,x){const _=u("PageHeader"),a=u("MonthlyStatsChart"),c=u("router-link");return r(),d("div",B,[m(_,{title:"Tổng quan"}),t("div",q,[e.loading?(r(),d("div",L,s[0]||(s[0]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"},null,-1)]))):e.error?(r(),d("div",W,[t("div",D,[s[2]||(s[2]=t("div",{class:"flex-shrink-0"},[t("i",{class:"fas fa-exclamation-circle text-red-500 text-lg"})],-1)),t("div",G,[s[1]||(s[1]=t("h3",{class:"text-sm font-medium text-red-800"},"Có lỗi xảy ra khi tải dữ liệu",-1)),t("div",K,i(e.error),1)])])])):(r(),d("div",R,[t("div",X,[t("div",Z,[t("div",z,[t("div",I,[s[5]||(s[5]=t("div",{class:"flex-shrink-0 bg-indigo-500 rounded-md p-3"},[t("i",{class:"fas fa-briefcase text-white"})],-1)),t("div",J,[t("dl",null,[s[4]||(s[4]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Tin tuyển dụng",-1)),t("dd",null,[t("div",O,i(e.statistics.total_posts),1),t("div",Q,[t("span",U,i(e.statistics.active_posts)+" hoạt động",1),s[3]||(s[3]=h(", ")),t("span",Y,i(e.statistics.expired_posts)+" hết hạn",1)])])])])])])]),t("div",$,[t("div",tt,[t("div",st,[s[8]||(s[8]=t("div",{class:"flex-shrink-0 bg-blue-500 rounded-md p-3"},[t("i",{class:"fas fa-user-tie text-white"})],-1)),t("div",et,[t("dl",null,[s[7]||(s[7]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Ứng viên",-1)),t("dd",null,[t("div",at,i(e.statistics.total_applicants),1),t("div",it,[t("span",ot,i(e.statistics.pending_applicants)+" chờ xử lý",1),s[6]||(s[6]=h(", ")),t("span",nt,i(e.statistics.approved_applicants)+" đã duyệt",1)])])])])])])]),t("div",lt,[t("div",dt,[t("div",rt,[s[11]||(s[11]=t("div",{class:"flex-shrink-0 bg-purple-500 rounded-md p-3"},[t("i",{class:"fas fa-comments text-white"})],-1)),t("div",ct,[t("dl",null,[s[10]||(s[10]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Phỏng vấn",-1)),t("dd",null,[t("div",pt,i(e.statistics.total_interviews),1),t("div",xt,[t("span",_t,i(e.statistics.upcoming_interviews)+" sắp diễn ra",1),s[9]||(s[9]=h(", ")),t("span",ht,i(e.statistics.completed_interviews)+" đã hoàn thành",1)])])])])])])]),t("div",gt,[t("div",ut,[t("div",mt,[s[14]||(s[14]=t("div",{class:"flex-shrink-0 bg-green-500 rounded-md p-3"},[t("i",{class:"fas fa-chart-line text-white"})],-1)),t("div",vt,[t("dl",null,[s[13]||(s[13]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Tỷ lệ chuyển đổi",-1)),t("dd",null,[t("div",yt,i(e.statisticsTotalPosts>0?(e.statisticsTotalApplicants/e.statisticsTotalPosts).toFixed(1):0),1),s[12]||(s[12]=t("div",{class:"text-xs text-gray-500"},"Ứng viên/tin đăng",-1))])])])])])])]),t("div",ft,[s[15]||(s[15]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Thống kê theo tháng",-1)),t("div",wt,[m(a,{data:e.statistics.monthly_stats},null,8,["data"])])]),t("div",bt,[s[19]||(s[19]=t("div",{class:"px-6 py-5 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Thống kê theo tin tuyển dụng"),t("p",{class:"mt-1 text-sm text-gray-500"},"10 tin tuyển dụng gần nhất của doanh nghiệp.")],-1)),t("div",kt,[t("table",Ct,[s[18]||(s[18]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tiêu đề "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tổng ứng viên "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Chờ xử lý "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Đã duyệt "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Đã từ chối "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Hành động ")])],-1)),t("tbody",Tt,[(r(!0),d(C,null,T(e.statistics.post_stats,o=>(r(),d("tr",{key:o.id},[t("td",St,[t("div",Pt,i(o.title),1)]),t("td",Et,[t("div",At,i(o.total_applicants),1)]),t("td",Mt,[t("div",Vt,i(o.pending_applicants),1)]),t("td",jt,[t("div",Ft,i(o.approved_applicants),1)]),t("td",Ht,[t("div",Nt,i(o.rejected_applicants),1)]),t("td",Bt,[m(c,{to:`/employer/posts/${o.id}`,class:"text-blue-600 hover:text-blue-900"},{default:S(()=>s[16]||(s[16]=[h(" Xem chi tiết ")])),_:2},1032,["to"])])]))),128)),e.statistics.post_stats.length===0?(r(),d("tr",qt,s[17]||(s[17]=[t("td",{colspan:"6",class:"px-6 py-4 text-center text-sm text-gray-500"}," Chưa có tin tuyển dụng nào ",-1)]))):k("",!0)])])])])]))])])}const Gt=f(N,[["render",Lt]]);export{Gt as default};
