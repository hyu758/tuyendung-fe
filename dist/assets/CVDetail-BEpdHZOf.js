import{_ as M,B as A,u as E,k as i,E as G,G as z,o as I,c as r,a as n,e,d as C,l as k,b as R,t as o,f as d,m as V,p as F,v as Q,n as T,O as U}from"./index-Cc90-Q6z.js";import{u as $}from"./cv-CgOeSdjj.js";const H={class:"min-h-screen bg-gray-50 py-8"},L={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},O={class:"flex items-center mb-6"},P={key:0,class:"space-y-6"},Z={key:1},q={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},J={class:"lg:col-span-2"},W={class:"bg-white shadow rounded-lg p-6"},X={class:"flex justify-between items-center mb-6"},Y={class:"text-xl font-semibold text-gray-900"},ee=["href"],te={class:"border border-gray-200 rounded-lg overflow-hidden"},se={key:0},ae=["data"],le={class:"p-8 bg-gray-100 flex flex-col items-center justify-center h-[750px]"},re={class:"flex space-x-4"},ne=["href"],oe={key:1,class:"w-full h-96 flex items-center justify-center bg-gray-100"},ie={class:"lg:col-span-1"},de={class:"bg-white shadow rounded-lg p-6 mb-6"},ue={class:"space-y-4"},ce={class:"relative"},ve={class:"pt-2"},me=["disabled"],ge={key:0,class:"flex items-center"},fe={key:1},xe={class:"mt-6 pt-4 border-t border-gray-200"},pe={class:"flex items-center mb-2"},be={key:0,class:"mt-2"},ye={class:"mt-1 text-sm text-gray-600 bg-gray-50 p-2 rounded"},he={class:"bg-white shadow rounded-lg p-6"},we={class:"space-y-4"},_e={class:"flex items-start"},Ce={class:"text-sm font-medium text-gray-900"},ke={class:"flex items-start"},Ve={class:"text-sm text-gray-900"},Te={class:"flex items-start"},Se={class:"text-sm text-gray-900"},De={class:"flex items-start"},je={class:"text-sm text-gray-900"},Ne={class:"flex items-start"},Be={class:"text-sm text-gray-900"},Ke={key:2,class:"bg-white shadow rounded-lg p-8 text-center"},Me={class:"flex"},Ae={class:"ml-3"},Ee={class:"text-sm font-medium text-green-800"},Ge={__name:"CVDetail",setup(ze){const p=A(),b=E(),m=$(),{addToast:v}=U(),y=i(!0),u=i("pending"),c=i(""),g=i(!1),f=i(!1),x=i(!1),h=i(""),s=G(()=>m.currentCV),S=a=>{try{if(!a)return"";const t=new Date(a.replace("+07:00","Z"));return isNaN(t.getTime())?"":new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(t)}catch(t){return console.error("Error formatting date:",t),""}},D=a=>{switch(a){case"pending":return"bg-yellow-100 text-yellow-800";case"not_viewed":return"bg-gray-100 text-gray-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=a=>{switch(a){case"pending":return"Chưa xử lý";case"not_viewed":return"Chưa xem";case"approved":return"Đã tiếp nhận";case"rejected":return"Đã từ chối";default:return"Không xác định"}},N=a=>{h.value=a,f.value=!0,x.value=!1,setTimeout(()=>{x.value=!0,setTimeout(()=>{f.value=!1},300)},5e3)},B=()=>{x.value=!0,setTimeout(()=>{f.value=!1},300)},K=async()=>{try{if(!s.value)return;if(g.value=!0,s.value.status!==u.value||s.value.note!==c.value){const a=await m.updateCVStatus(s.value.id,u.value,c.value);a.success?(N("Cập nhật trạng thái CV thành công"),s.value&&(s.value.status=u.value,s.value.note=c.value)):v({type:"error",message:a.error||"Không thể cập nhật trạng thái CV"})}else v({type:"info",message:"Không có thay đổi để lưu"})}catch(a){console.error("Error saving changes:",a),v({type:"error",message:"Đã xảy ra lỗi khi lưu thay đổi"})}finally{g.value=!1}},w=async()=>{var a,t;try{y.value=!0;const l=p.params.id;if(!l){b.push("/404");return}const _=await m.fetchCVById(l);if(!_.success){v({type:"error",message:_.error||"Không thể lấy thông tin CV"});return}u.value=((a=s.value)==null?void 0:a.status)||"pending",c.value=((t=s.value)==null?void 0:t.note)||""}catch(l){console.error("Error loading CV details:",l),v({type:"error",message:"Đã xảy ra lỗi khi tải thông tin CV"})}finally{y.value=!1}};return z(()=>p.params.id,(a,t)=>{a&&a!==t&&w()}),I(()=>{w(),m.markCVAsViewed(p.params.id)}),(a,t)=>(n(),r("div",H,[e("div",L,[e("div",O,[e("button",{onClick:t[0]||(t[0]=l=>k(b).back()),class:"mr-4 p-2 rounded-full hover:bg-gray-200 transition-colors",title:"Quay lại"},t[4]||(t[4]=[e("i",{class:"fas fa-arrow-left text-gray-600"},null,-1)])),t[5]||(t[5]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Chi tiết CV ứng viên",-1))]),y.value?(n(),r("div",P,t[6]||(t[6]=[R('<div class="grid grid-cols-1 lg:grid-cols-3 gap-6" data-v-79627ce1><div class="lg:col-span-2" data-v-79627ce1><div class="bg-white shadow rounded-lg p-6" data-v-79627ce1><div class="h-8 bg-gray-200 rounded w-1/3 animate-pulse mb-6" data-v-79627ce1></div><div class="h-96 bg-gray-200 rounded animate-pulse" data-v-79627ce1></div></div></div><div class="lg:col-span-1" data-v-79627ce1><div class="bg-white shadow rounded-lg p-6 mb-6" data-v-79627ce1><div class="h-6 bg-gray-200 rounded w-1/2 animate-pulse mb-4" data-v-79627ce1></div><div class="h-10 bg-gray-200 rounded animate-pulse mb-4" data-v-79627ce1></div><div class="h-32 bg-gray-200 rounded animate-pulse" data-v-79627ce1></div></div><div class="bg-white shadow rounded-lg p-6" data-v-79627ce1><div class="h-6 bg-gray-200 rounded w-1/2 animate-pulse mb-4" data-v-79627ce1></div><div class="space-y-2" data-v-79627ce1><div class="flex items-center" data-v-79627ce1><div class="h-10 w-10 bg-gray-200 rounded-full animate-pulse mr-3" data-v-79627ce1></div><div data-v-79627ce1><div class="h-4 bg-gray-200 rounded w-24 animate-pulse mb-1" data-v-79627ce1></div><div class="h-3 bg-gray-200 rounded w-16 animate-pulse" data-v-79627ce1></div></div></div></div></div></div></div>',1)]))):s.value?(n(),r("div",Z,[e("div",q,[e("div",J,[e("div",W,[e("div",X,[e("h2",Y,"CV của "+o(s.value.name),1),e("a",{href:s.value.cv_file_url,download:"",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors"},t[7]||(t[7]=[e("i",{class:"fas fa-download mr-2"},null,-1),d(" Tải xuống ")]),8,ee)]),e("div",te,[s.value.cv_file_url?(n(),r("div",se,[e("object",{data:s.value.cv_file_url,type:"application/pdf",class:"w-full h-screen max-h-[750px]"},[e("div",le,[t[9]||(t[9]=e("i",{class:"fas fa-file-pdf text-6xl text-red-500 mb-4"},null,-1)),t[10]||(t[10]=e("p",{class:"text-center text-gray-700 mb-4"}," Trình duyệt của bạn không hỗ trợ xem PDF trực tiếp ",-1)),e("div",re,[e("a",{href:s.value.cv_file_url,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors"},t[8]||(t[8]=[e("i",{class:"fas fa-external-link-alt mr-2"},null,-1),d(" Mở trong tab mới ")]),8,ne)])])],8,ae)])):(n(),r("div",oe,t[11]||(t[11]=[e("div",{class:"text-center"},[e("i",{class:"fas fa-file-pdf text-5xl text-gray-400 mb-3"}),e("p",{class:"text-gray-600"},"Không tìm thấy file CV")],-1)])))])])]),e("div",ie,[e("div",de,[t[20]||(t[20]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[e("i",{class:"fas fa-clipboard-check mr-2 text-blue-500"}),d(" Trạng thái CV ")],-1)),e("div",ue,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Cập nhật trạng thái ",-1)),e("div",ce,[V(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>u.value=l),class:"block w-full appearance-none border border-gray-300 rounded-md py-3 px-4 pr-8 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"},t[12]||(t[12]=[e("option",{value:"pending"},"Chưa xử lý",-1),e("option",{value:"not_viewed"},"Chưa xem",-1),e("option",{value:"approved"},"Đã tiếp nhận",-1),e("option",{value:"rejected"},"Đã từ chối",-1)]),512),[[F,u.value]]),t[13]||(t[13]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[e("i",{class:"fas fa-chevron-down text-gray-400"})],-1))])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Ghi chú ",-1)),V(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>c.value=l),rows:"4",class:"block w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Ghi chú về ứng viên này..."},null,512),[[Q,c.value]])]),e("div",ve,[e("button",{onClick:K,class:"w-full flex items-center justify-center px-4 py-3 border border-transparent rounded-md shadow-sm text-sm md:text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",disabled:g.value},[g.value?(n(),r("span",ge,t[16]||(t[16]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),d(" Đang lưu... ")]))):(n(),r("span",fe,t[17]||(t[17]=[e("i",{class:"fas fa-save mr-2"},null,-1),d(" Lưu thay đổi ")])))],8,me)])]),e("div",xe,[e("div",pe,[t[18]||(t[18]=e("span",{class:"text-sm font-medium text-gray-500"},"Trạng thái hiện tại:",-1)),e("span",{class:T(["ml-2 px-2.5 py-1 text-xs font-medium rounded-full",D(s.value.status)])},o(j(s.value.status)),3)]),s.value.note?(n(),r("div",be,[t[19]||(t[19]=e("span",{class:"text-sm font-medium text-gray-500"},"Ghi chú:",-1)),e("p",ye,o(s.value.note),1)])):C("",!0)])]),e("div",he,[t[26]||(t[26]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[e("i",{class:"fas fa-user mr-2 text-blue-500"}),d(" Thông tin ứng viên ")],-1)),e("div",we,[e("div",_e,[t[21]||(t[21]=e("i",{class:"fas fa-user text-gray-400 mt-1 mr-3 w-5"},null,-1)),e("div",null,[e("div",Ce,o(s.value.name),1)])]),e("div",ke,[t[22]||(t[22]=e("i",{class:"fas fa-envelope text-gray-400 mt-1 mr-3 w-5"},null,-1)),e("div",null,[e("div",Ve,o(s.value.email),1)])]),e("div",Te,[t[23]||(t[23]=e("i",{class:"fas fa-phone text-gray-400 mt-1 mr-3 w-5"},null,-1)),e("div",null,[e("div",Se,o(s.value.phone_number),1)])]),e("div",De,[t[24]||(t[24]=e("i",{class:"fas fa-calendar text-gray-400 mt-1 mr-3 w-5"},null,-1)),e("div",null,[e("div",je,"Ngày ứng tuyển: "+o(S(s.value.created_at)),1)])]),e("div",Ne,[t[25]||(t[25]=e("i",{class:"fas fa-briefcase text-gray-400 mt-1 mr-3 w-5"},null,-1)),e("div",null,[e("div",Be,o(s.value.description),1)])])])])])])])):(n(),r("div",Ke,[t[28]||(t[28]=e("i",{class:"fas fa-exclamation-triangle text-5xl text-yellow-500 mb-4"},null,-1)),t[29]||(t[29]=e("h2",{class:"text-2xl font-medium text-gray-900 mb-2"},"Không tìm thấy thông tin CV",-1)),t[30]||(t[30]=e("p",{class:"text-gray-600 mb-6"},"CV không tồn tại hoặc đã bị xóa",-1)),e("button",{onClick:t[3]||(t[3]=l=>k(b).back()),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors"},t[27]||(t[27]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),d(" Quay lại ")]))]))]),f.value?(n(),r("div",{key:0,class:T(["fixed bottom-4 right-4 bg-green-50 border-l-4 border-green-500 p-4 rounded-md shadow-lg max-w-md transition-all duration-300 ease-in-out transform translate-y-0 opacity-100",{"translate-y-10 opacity-0":x.value}])},[e("div",Me,[t[32]||(t[32]=e("div",{class:"flex-shrink-0"},[e("i",{class:"fas fa-check-circle text-green-500"})],-1)),e("div",Ae,[e("p",Ee,o(h.value),1)]),e("div",{class:"ml-auto pl-3"},[e("div",{class:"-mx-1.5 -my-1.5"},[e("button",{onClick:B,class:"inline-flex rounded-md p-1.5 text-green-500 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"},t[31]||(t[31]=[e("span",{class:"sr-only"},"Đóng",-1),e("i",{class:"fas fa-times"},null,-1)]))])])])],2)):C("",!0)]))}},Fe=M(Ge,[["__scopeId","data-v-79627ce1"]]);export{Fe as default};
