import{_ as F,i as H,j as g,E as V,k as q,r as G,c as l,o as n,d as t,b as p,f as x,w as v,e as o,t as d,F as M,g as E,n as h}from"./index-B7EK3ATv.js";import{u as U}from"./post-5p4vZ857.js";const X={class:"job-recommendations-page"},Z={class:"container mx-auto px-4 py-8"},O={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8"},Q={class:"bg-white rounded-lg shadow-sm overflow-hidden mb-8"},W={key:0,class:"flex justify-center items-center py-20"},Y={key:1,class:"p-8 text-center"},j={key:2,class:"p-8 text-center"},ee={class:"mt-6 flex flex-col sm:flex-row justify-center gap-4"},te={key:3},se={class:"p-6 border-b border-gray-200"},re={class:"flex items-center"},ie={class:"ml-3 text-lg font-medium text-gray-900"},le={class:"divide-y divide-gray-200"},ne={class:"flex flex-col md:flex-row"},ae={class:"flex-shrink-0 mb-4 md:mb-0"},oe={key:0,class:"h-16 w-16 rounded-md overflow-hidden bg-gray-100"},de=["src","alt"],ue={key:1,class:"h-16 w-16 rounded-md bg-blue-100 flex items-center justify-center text-blue-700 text-xl font-bold"},ce={class:"md:ml-6 flex-1"},me={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start"},fe={class:"text-lg font-medium text-gray-900"},ge={class:"text-gray-600 text-sm mb-1"},xe={class:"flex gap-2 items-center"},ve={key:0},he={key:1},ye={class:"flex flex-wrap gap-2 mt-3"},pe={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs bg-gray-100 text-gray-800"},be={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs bg-gray-100 text-gray-800"},_e={key:2,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs bg-blue-100 text-blue-800"},we={class:"mt-4 md:mt-0 md:ml-4"},ke={key:0,class:"text-green-600 font-medium"},Ce={key:1,class:"text-green-600 font-medium"},Pe={class:"text-gray-500 text-xs mt-1"},Te={class:"mt-4 flex items-center justify-between"},Ve={class:"text-sm text-gray-500"},Ne={class:"flex space-x-2"},$e=["onClick"],De={class:"px-6 py-4 border-t border-gray-200 flex items-center justify-between"},Je={class:"flex-1 flex justify-between sm:hidden"},Me=["disabled"],Ee=["disabled"],Le={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Se={class:"text-sm text-gray-700"},Be={class:"font-medium"},Ie={class:"font-medium"},Ke={class:"font-medium"},Re={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},ze=["disabled"],Ae=["onClick"],Fe=["disabled"],He={key:0,class:"bg-blue-50 border border-blue-100 rounded-lg p-6"},qe={class:"flex"},Ge={class:"ml-4"},Ue={class:"mt-1 text-sm text-blue-700"},Xe={__name:"JobRecommendations",setup(Ze){const y=H(),P=U(),_=g(!0),b=g(!1),f=g([]),i=g(1),w=g(10),c=g(0),m=g(1),L=V(()=>c.value===0?0:(i.value-1)*w.value+1),S=V(()=>{const r=i.value*w.value;return r>c.value?c.value:r}),B=V(()=>{const e=Math.floor(2.5),u=m.value;let s=Math.max(i.value-e,1),a=s+5-1;return a>u&&(a=u,s=Math.max(a-5+1,1)),Array.from({length:a-s+1},(T,C)=>s+C)}),I=r=>{try{if(!r)return"";const e=new Date(r.replace("+07:00","Z"));return isNaN(e.getTime())?"":new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}catch(e){return console.error("Error formatting date:",e),""}},N=r=>{if(!r)return"";const e=new Date(r),s=Math.abs(new Date-e),a=Math.floor(s/(1e3*60*60*24));return a===0?"hôm nay":a===1?"hôm qua":a<7?`${a} ngày trước`:a<30?`${Math.floor(a/7)} tuần trước`:I(r)},K=(r,e,u)=>{if(u)return"Thỏa thuận";const s=a=>a?(a/1e6).toLocaleString("vi-VN"):"";return r&&e?`${s(r)} - ${s(e)} triệu`:r?`Từ ${s(r)} triệu`:e?`Đến ${s(e)} triệu`:"Thỏa thuận"},R=r=>{if(!r)return"JH";try{return r.charAt(0).toUpperCase()}catch(e){return console.error("Error getting enterprise logo:",e),"JH"}},k=async()=>{_.value=!0;try{const r=await P.fetchRecommendedPosts(i.value,w.value);r&&r.data&&r.data.results?(f.value=r.data.results.map(e=>({id:e.id,title:e.title,enterprise:{name:e.enterprise_name,logo:e.enterprise_logo,is_premium:e.is_enterprise_premium},city:e.city,district:e.district,type_working:e.type_working,experience:e.experience,deadline:e.deadline,created_at:e.created_at,salary_min:e.salary_min,salary_max:e.salary_max,is_salary_negotiable:e.is_salary_negotiable,is_saved:e.is_saved,matchesCriteria:e.matches_criteria===!0})),c.value=r.data.total||0,m.value=Math.ceil(c.value/w.value),console.log(`Loaded ${f.value.length} recommended jobs`),console.log("Total items:",c.value),console.log("Total pages:",m.value),b.value=!1):(f.value=[],c.value=0,m.value=0,r&&r.noCriteria&&(b.value=!0,console.log("No criteria found")))}catch(r){console.error("Error fetching recommended jobs:",r),y.error("Có lỗi xảy ra khi tải danh sách việc làm gợi ý."),f.value=[],c.value=0,m.value=0}finally{_.value=!1}},z=async r=>{try{if(r.is_saved){const e=await P.deleteSavedPostByPostId(r.id);e.success?(y.success("Đã bỏ lưu bài đăng"),r.is_saved=!1):y.error(e.error||"Không thể bỏ lưu bài đăng.")}else{const e=await P.savePost(r.id);e.success?(y.success("Đã lưu bài đăng"),r.is_saved=!0):y.error(e.error||"Không thể lưu bài đăng.")}}catch(e){console.error("Error toggling saved status:",e),y.error("Không thể thực hiện thao tác. Vui lòng thử lại sau.")}},A=r=>{r!==i.value&&(i.value=r,k())},$=()=>{i.value>1&&(i.value--,k())},D=()=>{i.value<m.value&&(i.value++,k())};return q(()=>{console.log("JobRecommendations component mounted"),k().then(()=>{console.log("After fetching:",{jobs:f.value,totalItems:c.value,isLoading:_.value,hasNoCriteria:b.value})})}),(r,e)=>{const u=G("router-link");return n(),l("div",X,[t("div",Z,[t("div",O,[e[1]||(e[1]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Việc làm phù hợp với bạn"),t("p",{class:"text-gray-600 mt-1"},"Gợi ý dựa trên tiêu chí tìm việc của bạn")],-1)),x(u,{to:"/my-criteria",class:"mt-4 md:mt-0 inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:v(()=>e[0]||(e[0]=[t("i",{class:"fas fa-sliders-h mr-2"},null,-1),o(" Chỉnh sửa tiêu chí ")])),_:1})]),t("div",Q,[_.value?(n(),l("div",W,e[2]||(e[2]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):b.value?(n(),l("div",Y,[e[4]||(e[4]=t("div",{class:"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-blue-100 text-blue-500 mb-4"},[t("i",{class:"fas fa-filter text-3xl"})],-1)),e[5]||(e[5]=t("h3",{class:"text-lg font-medium text-gray-900"},"Chưa có tiêu chí tìm việc",-1)),e[6]||(e[6]=t("p",{class:"mt-2 text-gray-500 max-w-md mx-auto"}," Bạn cần thiết lập tiêu chí tìm việc để nhận được gợi ý việc làm phù hợp với mong muốn của mình. ",-1)),x(u,{to:"/my-criteria",class:"mt-6 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:v(()=>e[3]||(e[3]=[t("i",{class:"fas fa-plus-circle mr-2"},null,-1),o(" Tạo tiêu chí tìm việc ")])),_:1})])):f.value.length===0?(n(),l("div",j,[e[9]||(e[9]=t("div",{class:"mx-auto h-20 w-20 flex items-center justify-center rounded-full bg-yellow-100 text-yellow-500 mb-4"},[t("i",{class:"fas fa-search text-3xl"})],-1)),e[10]||(e[10]=t("h3",{class:"text-lg font-medium text-gray-900"},"Không tìm thấy việc làm phù hợp",-1)),e[11]||(e[11]=t("p",{class:"mt-2 text-gray-500 max-w-md mx-auto"}," Không có việc làm nào phù hợp với tiêu chí của bạn. Hãy thử điều chỉnh tiêu chí hoặc quay lại sau. ",-1)),t("div",ee,[x(u,{to:"/my-criteria",class:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:v(()=>e[7]||(e[7]=[t("i",{class:"fas fa-edit mr-2"},null,-1),o(" Điều chỉnh tiêu chí ")])),_:1}),x(u,{to:"/job-search",class:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:v(()=>e[8]||(e[8]=[t("i",{class:"fas fa-search mr-2"},null,-1),o(" Tìm kiếm việc làm ")])),_:1})])])):(n(),l("div",te,[t("div",se,[t("div",re,[e[12]||(e[12]=t("span",{class:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center"},[t("i",{class:"fas fa-thumbs-up text-blue-500"})],-1)),t("h3",ie,d(f.value.length)+" việc làm phù hợp với tiêu chí của bạn ",1)])]),t("div",le,[(n(!0),l(M,null,E(f.value,s=>{var a,T,C,J;return n(),l("div",{key:s.id,class:"p-6 hover:bg-gray-50 transition-colors"},[t("div",ne,[t("div",ae,[(a=s.enterprise)!=null&&a.logo?(n(),l("div",oe,[t("img",{src:s.enterprise.logo,alt:s.enterprise.name,class:"h-full w-full object-contain"},null,8,de)])):(n(),l("div",ue,d(R((T=s.enterprise)==null?void 0:T.name)),1))]),t("div",ce,[t("div",me,[t("div",null,[t("h3",fe,[x(u,{to:`/job/${s.id}`,class:"hover:text-blue-600"},{default:v(()=>[o(d(s.title),1)]),_:2},1032,["to"])]),t("p",ge,d(((C=s.enterprise)==null?void 0:C.name)||"Công ty ẩn danh"),1),t("div",xe,[(J=s.enterprise)!=null&&J.is_premium?(n(),l("div",ve,e[13]||(e[13]=[t("span",{class:"inline-flex items-center px-2 py-1 bg-amber-400 text-white rounded-full text-xs font-semibold shadow"}," Pro Company ",-1)]))):p("",!0),s.matchesCriteria?(n(),l("div",he,e[14]||(e[14]=[t("span",{class:"inline-flex items-center px-2 py-1 bg-green-500 text-white rounded-full text-xs font-semibold shadow"},[t("i",{class:"fas fa-check-circle mr-1"}),o(" Phù hợp ")],-1)]))):p("",!0)]),t("div",ye,[s.city?(n(),l("div",pe,[e[15]||(e[15]=t("i",{class:"fas fa-map-marker-alt text-gray-500 mr-1"},null,-1)),o(" "+d(s.city),1)])):p("",!0),s.experience?(n(),l("div",be,[e[16]||(e[16]=t("i",{class:"fas fa-briefcase text-gray-500 mr-1"},null,-1)),o(" "+d(s.experience),1)])):p("",!0),s.type_working?(n(),l("div",_e,d(s.type_working),1)):p("",!0)])]),t("div",we,[s.salary_min||s.salary_max?(n(),l("div",ke,d(K(s.salary_min,s.salary_max,s.is_salary_negotiable)),1)):(n(),l("div",Ce," Thỏa thuận ")),t("div",Pe,d(N(s.created_at)),1)])]),t("div",Te,[t("div",Ve,[e[17]||(e[17]=t("i",{class:"fas fa-calendar-alt mr-1"},null,-1)),o(" Đăng "+d(N(s.created_at)),1)]),t("div",Ne,[t("button",{onClick:Oe=>z(s),class:h(["inline-flex items-center px-3 py-1 border rounded-md text-sm font-medium",s.is_saved?"border-red-300 text-red-700 bg-red-50 hover:bg-red-100":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50"])},[t("i",{class:h(["mr-1.5",s.is_saved?"fas fa-heart text-red-500":"far fa-heart"])},null,2),o(" "+d(s.is_saved?"Đã lưu":"Lưu"),1)],10,$e),x(u,{to:`/jobs/${s.id}`,class:"inline-flex items-center px-3 py-1 border border-transparent rounded-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700"},{default:v(()=>e[18]||(e[18]=[o(" Xem chi tiết ")])),_:2},1032,["to"])])])])])])}),128))]),t("div",De,[t("div",Je,[t("button",{onClick:$,disabled:i.value===1,class:h([{"opacity-50 cursor-not-allowed":i.value===1},"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"])}," Trước ",10,Me),t("button",{onClick:D,disabled:i.value===m.value,class:h([{"opacity-50 cursor-not-allowed":i.value===m.value},"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"])}," Sau ",10,Ee)]),t("div",Le,[t("div",null,[t("p",Se,[e[19]||(e[19]=o(" Hiển thị ")),t("span",Be,d(L.value),1),e[20]||(e[20]=o(" đến ")),t("span",Ie,d(S.value),1),e[21]||(e[21]=o(" của ")),t("span",Ke,d(c.value),1),e[22]||(e[22]=o(" kết quả "))])]),t("div",null,[t("nav",Re,[t("button",{onClick:$,disabled:i.value===1,class:h([{"opacity-50 cursor-not-allowed":i.value===1},"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"])},e[23]||(e[23]=[t("span",{class:"sr-only"},"Previous",-1),t("i",{class:"fas fa-chevron-left text-xs"},null,-1)]),10,ze),(n(!0),l(M,null,E(B.value,s=>(n(),l("button",{key:s,onClick:a=>A(s),class:h([{"z-10 bg-blue-50 border-blue-500 text-blue-600":i.value===s,"bg-white border-gray-300 text-gray-500 hover:bg-gray-50":i.value!==s},"relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},d(s),11,Ae))),128)),t("button",{onClick:D,disabled:i.value===m.value,class:h([{"opacity-50 cursor-not-allowed":i.value===m.value},"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"])},e[24]||(e[24]=[t("span",{class:"sr-only"},"Next",-1),t("i",{class:"fas fa-chevron-right text-xs"},null,-1)]),10,Fe)])])])])]))]),!b.value&&f.value.length>0?(n(),l("div",He,[t("div",qe,[e[29]||(e[29]=t("div",{class:"flex-shrink-0"},[t("i",{class:"fas fa-lightbulb text-blue-400 text-xl"})],-1)),t("div",Ge,[e[28]||(e[28]=t("h4",{class:"text-base font-medium text-blue-800"},"Nhận thêm gợi ý phù hợp hơn",-1)),t("p",Ue,[e[26]||(e[26]=o(" Việc làm được gợi ý dựa trên tiêu chí tìm việc của bạn. ")),x(u,{to:"/my-criteria",class:"font-medium underline hover:text-blue-900"},{default:v(()=>e[25]||(e[25]=[o("Cập nhật tiêu chí")])),_:1}),e[27]||(e[27]=o(" để nhận gợi ý phù hợp hơn với mong muốn của bạn. "))])])])])):p("",!0)])])}}},Ye=F(Xe,[["__scopeId","data-v-25bf8b0a"]]);export{Ye as default};
