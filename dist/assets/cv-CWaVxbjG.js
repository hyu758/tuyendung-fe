import{I as o,C as i}from"./index-Ca2sGfzT.js";const h=o("cv",{state:()=>({cvs:[],currentCV:null,loading:!1,error:null}),actions:{async fetchCVsByPostId(e){try{this.loading=!0,this.error=null;const r=await i.get(`/api/cv/post/${e}/`);return r.data?(this.cvs=r.data.data.results,{success:!0,data:r.data.data}):{success:!1,error:"Không thể lấy danh sách CV"}}catch(r){return console.error("Error fetching CVs:",r),this.error=r.message||"Đã xảy ra lỗi khi lấy danh sách CV",{success:!1,error:this.error}}finally{this.loading=!1}},async fetchCVsByStatus(e=null,r=null){try{this.loading=!0,this.error=null;let t="/api/cv/status/";const s={};e&&(s.status=e),r!==null&&(s.is_marked=r);const a=await i.get(t,{params:s});return a.data?(this.cvs=a.data.data,{success:!0,data:a.data}):{success:!1,error:"Không thể lấy danh sách CV theo trạng thái"}}catch(t){return console.error("Error fetching CVs by status:",t),this.error=t.message||"Đã xảy ra lỗi khi lấy danh sách CV theo trạng thái",{success:!1,error:this.error}}finally{this.loading=!1}},async fetchCVById(e){var r;try{this.loading=!0,this.error=null;const t=await i.get(`/api/cv/${e}/`);return t.data&&t.status===200?(this.currentCV=t.data.data,{success:!0,data:t.data.data}):{success:!1,error:((r=t.data)==null?void 0:r.message)||"Không thể lấy thông tin CV"}}catch(t){return console.error("Error fetching CV details:",t),this.error=t.message||"Đã xảy ra lỗi khi lấy thông tin CV",{success:!1,error:this.error}}finally{this.loading=!1}},async updateCVStatus(e,r){var t;try{this.loading=!0,this.error=null;const s=await i.put(`/api/cv/${e}/status/`,{status:r});if(s.data&&s.status===200){const a=this.cvs.findIndex(n=>n.id===e);return a!==-1&&(this.cvs[a].status=r),this.currentCV&&this.currentCV.id===e&&(this.currentCV.status=r),{success:!0,data:s.data.data}}return{success:!1,error:((t=s.data)==null?void 0:t.message)||"Không thể cập nhật trạng thái CV"}}catch(s){return console.error("Error updating CV status:",s),this.error=s.message||"Đã xảy ra lỗi khi cập nhật trạng thái CV",{success:!1,error:this.error}}finally{this.loading=!1}},async markCV(e,r){var t;try{this.loading=!0,this.error=null;const s=await i.post(`/api/cv/${e}/mark/`,{mark_type:r});return s.data&&s.status===200?{success:!0,data:s.data.data}:{success:!1,error:((t=s.data)==null?void 0:t.message)||"Không thể đánh dấu CV"}}catch(s){return console.error("Error marking CV:",s),this.error=s.message||"Đã xảy ra lỗi khi đánh dấu CV",{success:!1,error:this.error}}finally{this.loading=!1}},async markCVAsViewed(e){try{this.loading=!0,this.error=null;const r=await i.post(`/api/cv/mark-as-viewed/${e}/`);if(r.data&&r.status===200)return{success:!0,data:r.data.data}}catch(r){return console.error("Error marking CV as viewed:",r),this.error=r.message||"Đã xảy ra lỗi khi đánh dấu CV đã xem",{success:!1,error:this.error}}finally{this.loading=!1}},async updateCVNote(e,r){var t;try{this.loading=!0,this.error=null;const s=await i.put(`/api/cv/${e}/note/`,{note:r});if(s.data&&s.status===200){const a=this.cvs.findIndex(n=>n.id===e);return a!==-1&&(this.cvs[a].note=r),this.currentCV&&this.currentCV.id===e&&(this.currentCV.note=r),{success:!0,data:s.data.data}}return{success:!1,error:((t=s.data)==null?void 0:t.message)||"Không thể cập nhật ghi chú CV"}}catch(s){return console.error("Error updating CV note:",s),this.error=s.message||"Đã xảy ra lỗi khi cập nhật ghi chú CV",{success:!1,error:this.error}}finally{this.loading=!1}}}});export{h as u};
