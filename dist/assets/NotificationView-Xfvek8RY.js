import{T as w,j as h,E as k,G as N,k as $,c as n,o as l,d as t,b as m,l as o,t as y,F as A,g as T,s as F,U as M,O as C,n as g,e as p,f as B}from"./index-BKTIbGvs.js";const S={class:"bg-white shadow-md rounded-lg overflow-hidden"},U={class:"px-4 py-3 bg-blue-50 border-b border-blue-100"},V={class:"flex items-center justify-between"},j={class:"flex items-center space-x-2"},E={key:0,class:"text-sm font-medium text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full"},R=["disabled"],K={key:0},L={key:1},H={key:0,class:"py-8 text-center"},X={key:1,class:"divide-y divide-gray-100"},z={key:0,class:"py-4 text-center"},D={key:1,class:"p-4 text-center"},G=["disabled"],O={key:0},q={key:1},I={key:2,class:"py-10 text-center"},J={key:3,class:"py-10 text-center"},P={__name:"NotificationList",props:{filter:{type:String,default:"all"}},setup(v){const r=v,s=w(),{addToast:d}=C(),a=h(r.filter),c=h(!1),x=k(()=>a.value==="all"?s.notifications:a.value==="unread"?s.notifications.filter(i=>!i.is_read):a.value==="applications"?s.notifications.filter(i=>["new_application","cv_viewed","application_withdrawn"].includes(i.notification_type)):a.value==="system"?s.notifications.filter(i=>i.notification_type==="system"):s.notifications),f=k(()=>a.value==="all"?!s.hasMore:s.hasMore?x.value.length===s.notifications.filter(i=>a.value==="unread"?!i.is_read:a.value==="applications"?["new_application","cv_viewed","application_withdrawn"].includes(i.notification_type):a.value==="system"?i.notification_type==="system":!0).length:!0);N(()=>r.filter,i=>{a.value=i}),$(async()=>{s.hasNotifications||await s.fetchNotifications(!0)});const e=async()=>{await s.fetchNotifications()},b=async()=>{try{c.value=!0;const i=await s.markAllAsRead();i.success?d({type:"success",message:"Đã đánh dấu tất cả thông báo là đã đọc"}):d({type:"error",message:i.error||"Không thể đánh dấu thông báo đã đọc"})}catch(i){console.error("Error marking all as read:",i),d({type:"error",message:"Đã xảy ra lỗi khi đánh dấu thông báo đã đọc"})}finally{c.value=!1}};return(i,u)=>(l(),n("div",S,[t("div",U,[t("div",V,[u[1]||(u[1]=t("h3",{class:"text-lg font-medium text-blue-800"},"Thông báo của bạn",-1)),t("div",j,[o(s).hasUnread?(l(),n("span",E,y(o(s).unreadCount)+" chưa đọc ",1)):m("",!0),o(s).hasUnread?(l(),n("button",{key:1,onClick:b,class:"text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center",disabled:c.value},[u[0]||(u[0]=t("i",{class:"fas fa-check-double mr-1"},null,-1)),c.value?(l(),n("span",K,"Đang xử lý...")):(l(),n("span",L,"Đánh dấu đã đọc"))],8,R)):m("",!0)])])]),o(s).loading&&!o(s).hasNotifications?(l(),n("div",H,u[2]||(u[2]=[t("i",{class:"fas fa-circle-notch fa-spin fa-2x text-blue-500 mb-3"},null,-1),t("p",{class:"text-gray-500"},"Đang tải thông báo...",-1)]))):o(s).hasNotifications?(l(),n("div",X,[(l(!0),n(A,null,T(x.value,_=>(l(),F(M,{key:_.id,notification:_},null,8,["notification"]))),128)),o(s).loading?(l(),n("div",z,u[3]||(u[3]=[t("i",{class:"fas fa-circle-notch fa-spin text-blue-500"},null,-1)]))):m("",!0),o(s).hasMore&&!f.value?(l(),n("div",D,[t("button",{onClick:e,class:"text-sm text-blue-600 hover:text-blue-800 font-medium",disabled:o(s).loading},[o(s).loading?(l(),n("span",O,"Đang tải...")):(l(),n("span",q,"Xem thêm"))],8,G)])):m("",!0)])):a.value!=="all"&&!o(s).hasNotifications?(l(),n("div",I,u[4]||(u[4]=[t("i",{class:"fas fa-filter text-gray-300 text-4xl mb-3"},null,-1),t("p",{class:"text-gray-500"},"Không có thông báo nào phù hợp với bộ lọc",-1)]))):(l(),n("div",J,u[5]||(u[5]=[t("i",{class:"fas fa-bell-slash text-gray-300 text-4xl mb-3"},null,-1),t("p",{class:"text-gray-500"},"Bạn chưa có thông báo nào",-1)])))]))}},Q={class:"min-h-screen bg-gray-50 py-8"},W={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Y={class:"bg-white shadow-md rounded-lg overflow-hidden mb-6"},Z={class:"grid grid-cols-1 lg:grid-cols-4 gap-0"},tt={class:"lg:col-span-1 border-r border-gray-200"},et={class:"p-4"},st={class:"space-y-2"},lt={class:"ml-2 bg-gray-100 text-gray-700 text-xs font-medium px-2 py-0.5 rounded-full"},nt={key:0,class:"ml-2 bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded-full"},ot={class:"mt-6"},at=["disabled"],it={key:0},rt={key:1},dt={class:"lg:col-span-3"},ut={class:"lg:hidden flex overflow-x-auto pb-2 mb-4 -mt-2 space-x-2"},ct={key:0,class:"ml-1 bg-blue-500 text-white text-xs w-4 h-4 inline-flex items-center justify-center rounded-full"},ft=["disabled"],bt={key:0},gt={key:1},mt={__name:"NotificationView",setup(v){const r=w(),{addToast:s}=C(),d=h("all"),a=h(!1),c=f=>{d.value=f,r.setFilter(f),r.fetchNotifications(!0)},x=async()=>{try{a.value=!0;const f=await r.markAllAsRead();f.success?s({type:"success",message:"Đã đánh dấu tất cả thông báo là đã đọc"}):s({type:"error",message:f.error||"Không thể đánh dấu thông báo đã đọc"})}catch(f){console.error("Error marking all as read:",f),s({type:"error",message:"Đã xảy ra lỗi khi đánh dấu thông báo đã đọc"})}finally{a.value=!1}};return $(()=>{r.fetchNotifications(!0)}),(f,e)=>(l(),n("div",Q,[t("div",W,[e[18]||(e[18]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"Thông báo"),t("p",{class:"mt-2 text-sm text-gray-600"},"Xem các thông báo và cập nhật từ hệ thống")],-1)),t("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[e[11]||(e[11]=t("h3",{class:"text-lg font-medium text-gray-800 mb-4"},"Lọc thông báo",-1)),t("div",st,[t("button",{onClick:e[0]||(e[0]=b=>c("all")),class:g(["w-full text-left px-3 py-2 rounded-md transition-colors",d.value==="all"?"bg-blue-50 text-blue-700":"hover:bg-gray-100"])},[e[6]||(e[6]=t("i",{class:"fas fa-bell mr-2"},null,-1)),e[7]||(e[7]=p(" Tất cả thông báo ")),t("span",lt,y(o(r).total),1)],2),t("button",{onClick:e[1]||(e[1]=b=>c("unread")),class:g(["w-full text-left px-3 py-2 rounded-md transition-colors",d.value==="unread"?"bg-blue-50 text-blue-700":"hover:bg-gray-100"])},[e[8]||(e[8]=t("i",{class:"fas fa-envelope mr-2"},null,-1)),e[9]||(e[9]=p(" Chưa đọc ")),o(r).unreadCount>0?(l(),n("span",nt,y(o(r).unreadCount),1)):m("",!0)],2)]),t("div",ot,[t("button",{onClick:x,class:"w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:!o(r).hasUnread||a.value},[e[10]||(e[10]=t("i",{class:"fas fa-check-double mr-2"},null,-1)),a.value?(l(),n("span",it,"Đang xử lý...")):(l(),n("span",rt,"Đánh dấu tất cả đã đọc"))],8,at)])])]),t("div",dt,[B(P,{filter:d.value},null,8,["filter"])])])]),t("div",ut,[t("button",{onClick:e[2]||(e[2]=b=>c("all")),class:g(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",d.value==="all"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},e[12]||(e[12]=[t("i",{class:"fas fa-bell mr-1"},null,-1),p(" Tất cả ")]),2),t("button",{onClick:e[3]||(e[3]=b=>c("unread")),class:g(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",d.value==="unread"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},[e[13]||(e[13]=t("i",{class:"fas fa-envelope mr-1"},null,-1)),e[14]||(e[14]=p(" Chưa đọc ")),o(r).unreadCount>0?(l(),n("span",ct,y(o(r).unreadCount>9?"9+":o(r).unreadCount),1)):m("",!0)],2),t("button",{onClick:e[4]||(e[4]=b=>c("applications")),class:g(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",d.value==="applications"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},e[15]||(e[15]=[t("i",{class:"fas fa-file-alt mr-1"},null,-1),p(" Hồ sơ ")]),2),t("button",{onClick:e[5]||(e[5]=b=>c("system")),class:g(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",d.value==="system"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},e[16]||(e[16]=[t("i",{class:"fas fa-cog mr-1"},null,-1),p(" Hệ thống ")]),2),t("button",{onClick:x,class:"whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:!o(r).hasUnread||a.value},[e[17]||(e[17]=t("i",{class:"fas fa-check-double mr-1"},null,-1)),a.value?(l(),n("span",bt,"Đang xử lý...")):(l(),n("span",gt,"Đánh dấu đã đọc"))],8,ft)])])]))}};export{mt as default};
