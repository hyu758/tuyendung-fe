import{S as h,j as x,E as v,G as w,o as _,c as a,a as l,e,d as p,p as i,t as m,F as k,h as $,k as C,T as N,n as f,f as b,g as T}from"./index-DfuhKBsv.js";import{u as F}from"./useToast-B6sEZtkc.js";const M={class:"bg-white shadow-md rounded-lg overflow-hidden"},S={class:"px-4 py-3 bg-blue-50 border-b border-blue-100"},A={class:"flex items-center justify-between"},B={key:0,class:"text-sm font-medium text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full"},V={key:0,class:"py-8 text-center"},j={key:1,class:"divide-y divide-gray-100"},E={key:0,class:"py-4 text-center"},L={key:1,class:"p-4 text-center"},U=["disabled"],H={key:0},K={key:1},R={key:2,class:"py-10 text-center"},X={key:3,class:"py-10 text-center"},z={__name:"NotificationList",props:{filter:{type:String,default:"all"}},setup(y){const r=y,s=h(),n=x(r.filter),u=v(()=>n.value==="all"?s.notifications:n.value==="unread"?s.notifications.filter(o=>!o.is_read):n.value==="applications"?s.notifications.filter(o=>["new_application","cv_viewed","application_withdrawn"].includes(o.notification_type)):n.value==="system"?s.notifications.filter(o=>o.notification_type==="system"):s.notifications),d=v(()=>n.value==="all"?!s.hasMore:s.hasMore?u.value.length===s.notifications.filter(o=>n.value==="unread"?!o.is_read:n.value==="applications"?["new_application","cv_viewed","application_withdrawn"].includes(o.notification_type):n.value==="system"?o.notification_type==="system":!0).length:!0);w(()=>r.filter,o=>{n.value=o}),_(async()=>{s.hasNotifications||await s.fetchNotifications(!0)});const g=async()=>{await s.fetchNotifications()};return(o,t)=>(l(),a("div",M,[e("div",S,[e("div",A,[t[0]||(t[0]=e("h3",{class:"text-lg font-medium text-blue-800"},"Thông báo của bạn",-1)),i(s).hasUnread?(l(),a("span",B,m(i(s).unreadCount)+" chưa đọc ",1)):p("",!0)])]),i(s).loading&&!i(s).hasNotifications?(l(),a("div",V,t[1]||(t[1]=[e("i",{class:"fas fa-circle-notch fa-spin fa-2x text-blue-500 mb-3"},null,-1),e("p",{class:"text-gray-500"},"Đang tải thông báo...",-1)]))):i(s).hasNotifications?(l(),a("div",j,[(l(!0),a(k,null,$(u.value,c=>(l(),C(N,{key:c.id,notification:c},null,8,["notification"]))),128)),i(s).loading?(l(),a("div",E,t[2]||(t[2]=[e("i",{class:"fas fa-circle-notch fa-spin text-blue-500"},null,-1)]))):p("",!0),i(s).hasMore&&!d.value?(l(),a("div",L,[e("button",{onClick:g,class:"text-sm text-blue-600 hover:text-blue-800 font-medium",disabled:i(s).loading},[i(s).loading?(l(),a("span",H,"Đang tải...")):(l(),a("span",K,"Xem thêm"))],8,U)])):p("",!0)])):n.value!=="all"&&!i(s).hasNotifications?(l(),a("div",R,t[3]||(t[3]=[e("i",{class:"fas fa-filter text-gray-300 text-4xl mb-3"},null,-1),e("p",{class:"text-gray-500"},"Không có thông báo nào phù hợp với bộ lọc",-1)]))):(l(),a("div",X,t[4]||(t[4]=[e("i",{class:"fas fa-bell-slash text-gray-300 text-4xl mb-3"},null,-1),e("p",{class:"text-gray-500"},"Bạn chưa có thông báo nào",-1)])))]))}},D={class:"min-h-screen bg-gray-50 py-8"},G={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},q={class:"bg-white shadow-md rounded-lg overflow-hidden mb-6"},I={class:"grid grid-cols-1 lg:grid-cols-4 gap-0"},J={class:"lg:col-span-1 border-r border-gray-200"},O={class:"p-4"},P={class:"space-y-2"},Q={class:"ml-2 bg-gray-100 text-gray-700 text-xs font-medium px-2 py-0.5 rounded-full"},W={key:0,class:"ml-2 bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded-full"},Y={class:"mt-6"},Z=["disabled"],tt={key:0},et={key:1},st={class:"lg:col-span-3"},ot={class:"lg:hidden flex overflow-x-auto pb-2 mb-4 -mt-2 space-x-2"},nt={key:0,class:"ml-1 bg-blue-500 text-white text-xs w-4 h-4 inline-flex items-center justify-center rounded-full"},lt=["disabled"],at={key:0},it={key:1},dt={__name:"NotificationView",setup(y){const r=h(),{addToast:s}=F(),n=x("all"),u=x(!1),d=o=>{n.value=o,r.setFilter(o),r.fetchNotifications(!0)},g=async()=>{try{u.value=!0;const o=await r.markAllAsRead();o.success?s({type:"success",message:"Đã đánh dấu tất cả thông báo là đã đọc"}):s({type:"error",message:o.error||"Không thể đánh dấu thông báo đã đọc"})}catch(o){console.error("Error marking all as read:",o),s({type:"error",message:"Đã xảy ra lỗi khi đánh dấu thông báo đã đọc"})}finally{u.value=!1}};return _(()=>{r.fetchNotifications(!0)}),(o,t)=>(l(),a("div",D,[e("div",G,[t[18]||(t[18]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Thông báo"),e("p",{class:"mt-2 text-sm text-gray-600"},"Xem các thông báo và cập nhật từ hệ thống")],-1)),e("div",q,[e("div",I,[e("div",J,[e("div",O,[t[11]||(t[11]=e("h3",{class:"text-lg font-medium text-gray-800 mb-4"},"Lọc thông báo",-1)),e("div",P,[e("button",{onClick:t[0]||(t[0]=c=>d("all")),class:f(["w-full text-left px-3 py-2 rounded-md transition-colors",n.value==="all"?"bg-blue-50 text-blue-700":"hover:bg-gray-100"])},[t[6]||(t[6]=e("i",{class:"fas fa-bell mr-2"},null,-1)),t[7]||(t[7]=b(" Tất cả thông báo ")),e("span",Q,m(i(r).total),1)],2),e("button",{onClick:t[1]||(t[1]=c=>d("unread")),class:f(["w-full text-left px-3 py-2 rounded-md transition-colors",n.value==="unread"?"bg-blue-50 text-blue-700":"hover:bg-gray-100"])},[t[8]||(t[8]=e("i",{class:"fas fa-envelope mr-2"},null,-1)),t[9]||(t[9]=b(" Chưa đọc ")),i(r).unreadCount>0?(l(),a("span",W,m(i(r).unreadCount),1)):p("",!0)],2)]),e("div",Y,[e("button",{onClick:g,class:"w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 transition-colors disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:!i(r).hasUnread||u.value},[t[10]||(t[10]=e("i",{class:"fas fa-check-double mr-2"},null,-1)),u.value?(l(),a("span",tt,"Đang xử lý...")):(l(),a("span",et,"Đánh dấu tất cả đã đọc"))],8,Z)])])]),e("div",st,[T(z,{filter:n.value},null,8,["filter"])])])]),e("div",ot,[e("button",{onClick:t[2]||(t[2]=c=>d("all")),class:f(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",n.value==="all"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},t[12]||(t[12]=[e("i",{class:"fas fa-bell mr-1"},null,-1),b(" Tất cả ")]),2),e("button",{onClick:t[3]||(t[3]=c=>d("unread")),class:f(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",n.value==="unread"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},[t[13]||(t[13]=e("i",{class:"fas fa-envelope mr-1"},null,-1)),t[14]||(t[14]=b(" Chưa đọc ")),i(r).unreadCount>0?(l(),a("span",nt,m(i(r).unreadCount>9?"9+":i(r).unreadCount),1)):p("",!0)],2),e("button",{onClick:t[4]||(t[4]=c=>d("applications")),class:f(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",n.value==="applications"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},t[15]||(t[15]=[e("i",{class:"fas fa-file-alt mr-1"},null,-1),b(" Hồ sơ ")]),2),e("button",{onClick:t[5]||(t[5]=c=>d("system")),class:f(["whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors",n.value==="system"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},t[16]||(t[16]=[e("i",{class:"fas fa-cog mr-1"},null,-1),b(" Hệ thống ")]),2),e("button",{onClick:g,class:"whitespace-nowrap px-3 py-1.5 rounded-full text-sm font-medium transition-colors bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:!i(r).hasUnread||u.value},[t[17]||(t[17]=e("i",{class:"fas fa-check-double mr-1"},null,-1)),u.value?(l(),a("span",at,"Đang xử lý...")):(l(),a("span",it,"Đánh dấu đã đọc"))],8,lt)])])]))}};export{dt as default};
