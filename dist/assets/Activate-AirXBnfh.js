import{i as N,B as S,u as T,j as n,o as K,r as b,c as h,a as i,e,k as w,d as _,l as V,g as r,f as v,t as L,b as j,w as D}from"./index-GBlyaDil.js";import{_ as C}from"./BaseButton-hJFN_hXD.js";const E={class:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},I={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},q={class:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},G={key:2},M={class:"text-center py-4"},R={class:"text-gray-600 mb-4"},H={class:"font-medium"},Q={class:"mt-6 border-t border-gray-200 pt-6"},z={class:"mt-6"},F={class:"mt-6 text-center"},J={key:3,class:"text-center py-4"},W={__name:"Activate",setup(O){const g=N(),u=S();T();const d=n(u.params.email||u.query.email||""),x=u.params.token||u.query.token||"",k=n(!1),c=n(!1),a=n(""),o=n(""),f=n(!1),l=n(0);let m=null;const $=async()=>{if(!(l.value>0)){if(!d.value){a.value="Email không được để trống. Vui lòng nhập email của bạn.";return}c.value=!0;try{const s=await g.resendActivationCode({email:d.value});s.success?(o.value=s.message||"Email kích hoạt mới đã được gửi. Vui lòng kiểm tra hộp thư của bạn.",l.value=60,m=setInterval(()=>{l.value--,l.value<=0&&clearInterval(m)},1e3)):a.value=s.error}catch(s){a.value="Đã xảy ra lỗi khi gửi lại email kích hoạt. Vui lòng thử lại sau.",console.error("Lỗi gửi lại email kích hoạt:",s)}finally{c.value=!1}}},A=async s=>{if(s){k.value=!0,a.value="";try{const t=await g.activateAccount({token:s});t.success?(o.value=t.message||"Tài khoản đã được kích hoạt thành công!",f.value=!0):a.value=t.error||"Không thể kích hoạt tài khoản. Token không hợp lệ hoặc đã hết hạn."}catch(t){a.value="Đã xảy ra lỗi khi kích hoạt tài khoản. Vui lòng thử lại.",console.error("Lỗi kích hoạt:",t)}finally{k.value=!1}}};return K(()=>(x&&A(x),()=>{m&&clearInterval(m)})),(s,t)=>{const p=b("font-awesome-icon"),B=b("router-link");return i(),h("div",E,[t[13]||(t[13]=e("div",{class:"sm:mx-auto sm:w-full sm:max-w-md"},[e("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," Kích hoạt tài khoản "),e("p",{class:"mt-2 text-center text-sm text-gray-600"}," Vui lòng kiểm tra email của bạn để kích hoạt tài khoản ")],-1)),e("div",I,[e("div",q,[a.value?(i(),w(V,{key:0,variant:"error",message:a.value,dismissible:"",onDismiss:t[0]||(t[0]=y=>a.value=""),class:"mb-4"},null,8,["message"])):_("",!0),o.value?(i(),w(V,{key:1,variant:"success",message:o.value,dismissible:"",onDismiss:t[1]||(t[1]=y=>o.value=""),class:"mb-4"},null,8,["message"])):_("",!0),f.value?(i(),h("div",J,[r(p,{icon:["fas","check-circle"],class:"text-green-500 text-5xl mb-4"}),t[11]||(t[11]=e("h3",{class:"text-lg font-medium text-gray-900"},"Tài khoản đã được kích hoạt thành công!",-1)),t[12]||(t[12]=e("p",{class:"mt-2 text-sm text-gray-600 mb-6"}," Bạn đã có thể đăng nhập và sử dụng đầy đủ các tính năng của ứng dụng. ",-1)),r(C,{onClick:t[2]||(t[2]=y=>s.$router.push("/login")),variant:"primary",label:"Đăng nhập ngay",class:"mx-auto"})])):(i(),h("div",G,[e("div",M,[r(p,{icon:["fas","envelope"],class:"text-blue-500 text-5xl mb-4"}),t[8]||(t[8]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Kiểm tra hộp thư của bạn",-1)),e("p",R,[t[3]||(t[3]=v(" Chúng tôi đã gửi một email chứa liên kết kích hoạt đến ")),e("span",H,L(d.value),1),t[4]||(t[4]=v(". ")),t[5]||(t[5]=e("br",null,null,-1)),t[6]||(t[6]=v("Vui lòng kiểm tra hộp thư và nhấp vào liên kết để kích hoạt tài khoản. "))]),e("div",Q,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600 mb-4"},"Không nhận được email kích hoạt?",-1)),r(C,{onClick:$,variant:"secondary",loading:c.value,disabled:c.value||l.value>0,label:l.value>0?`Gửi lại sau ${l.value}s`:"Gửi lại email kích hoạt",class:"mx-auto"},null,8,["loading","disabled","label"])])]),e("div",z,[t[10]||(t[10]=j('<div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500"> Hoặc </span></div></div>',1)),e("div",F,[r(B,{to:"/login",class:"font-medium text-blue-600 hover:text-blue-500 transition-colors"},{default:D(()=>t[9]||(t[9]=[v(" Quay lại đăng nhập ")])),_:1})])])]))])])])}}};export{W as default};
