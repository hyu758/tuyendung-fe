import{I as o,C as a}from"./index-Cd2jS5EI.js";const c=o("field",{state:()=>({fields:[],positions:[],positionsCache:new Map,loading:!1,loadingPositions:!1,error:null}),actions:{async fetchFields(s={page:1,page_size:100}){var r,t;try{this.loading=!0;const e=await a.get("/api/fields/",{params:s});return this.fields=e.data.data.results,{success:!0,data:e.data.data.results}}catch(e){return this.error=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Có lỗi xảy ra khi tải danh sách lĩnh vực",{success:!1,error:this.error}}finally{this.loading=!1}},async fetchPositionsByField(s){var r,t;if(this.positionsCache.has(s)){const e=this.positionsCache.get(s);return this.positions=e,{success:!0,data:e}}try{this.loadingPositions=!0;const i=(await a.get(`/api/positions/field/${s}/`)).data.data;return this.positionsCache.set(s,i),this.positions=i,{success:!0,data:i}}catch(e){return this.error=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Có lỗi xảy ra khi tải danh sách vị trí",{success:!1,error:this.error}}finally{this.loadingPositions=!1}},async getPositionById(s){var r,t;try{return{success:!0,data:(await a.get(`/api/position/${s}/`)).data}}catch(e){return this.error=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Có lỗi xảy ra khi tải thông tin vị trí",{success:!1,error:this.error}}},async getFieldById(s){var r,t;try{return{success:!0,data:(await a.get(`/api/fields/${s}/`)).data}}catch(e){return this.error=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Có lỗi xảy ra khi tải thông tin lĩnh vực",{success:!1,error:this.error}}}}}),d=o("address",{state:()=>({provinces:[],selectedProvince:null,districts:[],loading:!1,error:null}),getters:{getDistrictsByProvince:s=>{if(!s.selectedProvince)return[];const r=s.provinces.find(t=>t.code===parseInt(s.selectedProvince));return r?r.districts:[]}},actions:{async fetchProvinces(){try{const s=localStorage.getItem("provinces");if(s){const{data:e,timestamp:i}=JSON.parse(s);if(Date.now()-i<24*60*60*1e3)return this.provinces=e,{success:!0,data:e}}this.loading=!0;const t=await(await fetch("https://provinces.open-api.vn/api/?depth=2")).json();return this.provinces=t,localStorage.setItem("provinces",JSON.stringify({data:t,timestamp:Date.now()})),{success:!0,data:t}}catch(s){return this.error=s.message,{success:!1,error:s.message}}finally{this.loading=!1}},setSelectedProvince(s){const r=parseInt(s);this.selectedProvince=r;const t=this.provinces.find(e=>e.code===r);t?this.districts=t.districts:this.districts=[]}}});export{c as a,d as u};
