import{u as R,j as u,k as Z,r as G,c as o,o as r,b as h,d as e,n as x,t as l,f as E,w as H,e as v,F as V,g as B}from"./index-Bw2aqbXG.js";import{u as J}from"./post-BCdBhIb4.js";const O={class:"min-h-screen bg-gray-50 py-8"},Q={key:0,class:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50"},U={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl transform transition-all"},W={class:"flex justify-end space-x-3"},Y={key:1,class:"fixed top-4 right-4 z-50"},tt={class:"flex items-center"},et={key:2,class:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50"},st={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl transform transition-all"},nt={class:"text-lg font-medium text-gray-900 mb-4"},at={key:0,class:"text-gray-600 mb-6"},ot={key:1,class:"text-gray-600 mb-6"},rt={class:"flex justify-end space-x-4"},it={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},lt={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-8 gap-4"},ut={key:0,class:"flex justify-center py-12"},dt={key:1,class:"text-center py-12"},ct={class:"mt-6"},gt={key:2,class:"bg-white shadow rounded-lg overflow-hidden"},xt={class:"overflow-x-auto"},mt={class:"min-w-full divide-y divide-gray-200"},ft={class:"bg-white divide-y divide-gray-200"},vt={class:"px-4 sm:px-6 py-4"},yt={class:"text-sm text-gray-900 font-medium"},pt={class:"text-xs text-gray-500 mt-1"},bt={class:"px-2 sm:px-6 py-4 text-center text-sm text-gray-500 whitespace-nowrap"},ht={class:"inline-flex items-center justify-center px-2 py-1 rounded-full bg-blue-100 text-blue-800 text-xs font-medium"},_t={class:"px-2 sm:px-6 py-4 text-center text-sm whitespace-nowrap"},wt={class:"px-4 sm:px-6 py-4 text-center text-sm whitespace-nowrap"},kt={class:"flex flex-wrap justify-center gap-1 sm:gap-3"},Pt=["onClick","title"],Ct=["onClick","title"],Dt=["onClick"],jt=["onClick","title"],St={key:0,class:"px-4 sm:px-6 py-3 flex flex-col sm:flex-row items-center justify-between bg-gray-50"},$t={class:"text-sm text-gray-700 mb-2 sm:mb-0"},zt={class:"font-medium"},Nt={class:"font-medium"},Tt={class:"font-medium"},Et={class:"flex space-x-1"},Ht=["disabled"],Vt=["onClick"],Bt=["disabled"],Kt={__name:"PostList",setup(It){const _=R(),w=J(),k=u(!0),c=u([]),y=u(!1),i=u(null),P=u(!1),C=u(""),S=u(""),g=u(!1),a=u({currentPage:1,totalPages:1,totalItems:0,pageSize:10}),m=s=>{if(!s||!s.deadline)return!1;const t=new Date(s.deadline),d=new Date;return d.setHours(0,0,0,0),t<d},$=s=>{try{if(!s)return"";const t=new Date(s.replace("+07:00","Z"));return isNaN(t.getTime())?"":new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(t)}catch(t){return console.error("Error formatting date:",t),""}},I=()=>{const s=a.value.totalPages,t=a.value.currentPage;return s<=5?Array.from({length:s},(d,p)=>p+1):t<=3?[1,2,3,4,5]:t>=s-2?[s-4,s-3,s-2,s-1,s]:[t-2,t-1,t,t+1,t+2]},D=async()=>{try{k.value=!0;const s=await w.fetchPostByEmployer(a.value.currentPage,a.value.pageSize);s.success&&(c.value=s.data.data.results||[],a.value={currentPage:s.data.data.page||1,totalPages:s.data.data.total_pages||1,totalItems:s.data.data.total||0,pageSize:s.data.data.page_size||10})}catch(s){console.error("Error loading posts:",s)}finally{k.value=!1}},j=s=>{s>=1&&s<=a.value.totalPages&&(a.value.currentPage=s,D())},X=s=>{_.push({name:"EditPost",params:{id:s.id}})},M=s=>{g.value=!1,_.push({name:"EditPost",params:{id:s.id},query:{focus:"deadline"}})},K=s=>{_.push({name:"PostDetail",params:{id:s.id}})},F=s=>{i.value=s,y.value=!0},f=(s,t)=>{C.value=s,S.value=t,P.value=!0,setTimeout(()=>{P.value=!1},3e3)},L=async s=>{try{y.value=!1;const t=await w.deletePost(s.id);t.success?(f("success","Xóa tin tuyển dụng thành công"),await D()):f("error",t.error||"Có lỗi xảy ra khi xóa tin tuyển dụng")}catch(t){console.error("Error deleting post:",t),f("error","Có lỗi xảy ra khi xóa tin tuyển dụng")}},q=s=>{i.value=s,g.value=!0},A=async()=>{if(i.value)try{if(!i.value.is_active&&m(i.value)){f("error","Không thể kích hoạt vì hạn ứng tuyển đã hết"),g.value=!1;return}if((await w.togglePostStatus(i.value.id)).success){const t=c.value.findIndex(d=>d.id===i.value.id);t!==-1&&(c.value[t].is_active=!c.value[t].is_active),f("success",c.value[t].is_active?"Đã kích hoạt tin tuyển dụng":"Đã ẩn tin tuyển dụng"),g.value=!1}}catch(s){console.error("Error toggling post status:",s),f("error","Có lỗi xảy ra khi thay đổi trạng thái tin tuyển dụng"),g.value=!1}};return Z(D),(s,t)=>{var p,z,N,T;const d=G("router-link");return r(),o("div",O,[y.value?(r(),o("div",Q,[e("div",U,[t[6]||(t[6]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Xác nhận xóa",-1)),t[7]||(t[7]=e("p",{class:"text-gray-500 mb-6"},"Bạn có chắc chắn muốn xóa tin tuyển dụng này? Hành động này không thể hoàn tác.",-1)),e("div",W,[e("button",{onClick:t[0]||(t[0]=n=>y.value=!1),class:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition-colors duration-200 cursor-pointer"}," Hủy "),e("button",{onClick:t[1]||(t[1]=n=>L(i.value)),class:"px-4 py-2 border border-transparent rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-colors duration-200 cursor-pointer"}," Xóa ")])])])):h("",!0),P.value?(r(),o("div",Y,[e("div",{class:x(["rounded-lg p-4 shadow-lg",C.value==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[e("div",tt,[e("i",{class:x(["mr-2",C.value==="success"?"fas fa-check-circle":"fas fa-exclamation-circle"])},null,2),e("span",null,l(S.value),1)])],2)])):h("",!0),g.value?(r(),o("div",et,[e("div",st,[e("h3",nt,l((p=i.value)!=null&&p.is_active?"Ẩn bài đăng":"Hiển thị bài đăng"),1),!((z=i.value)!=null&&z.is_active)&&m(i.value)?(r(),o("p",at," Không thể kích hoạt tin tuyển dụng vì hạn ứng tuyển đã hết. Vui lòng cập nhật hạn ứng tuyển trước. ")):(r(),o("p",ot," Bạn có chắc chắn muốn "+l((N=i.value)!=null&&N.is_active?"ẩn":"hiển thị")+" bài đăng này? ",1)),e("div",rt,[e("button",{onClick:t[2]||(t[2]=n=>g.value=!1),class:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition-colors duration-200 cursor-pointer"}," Hủy "),!((T=i.value)!=null&&T.is_active)&&m(i.value)?(r(),o("button",{key:0,onClick:t[3]||(t[3]=n=>M(i.value)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors duration-200 cursor-pointer"}," Cập nhật hạn ứng tuyển ")):(r(),o("button",{key:1,onClick:A,class:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors duration-200 cursor-pointer"}," Xác nhận "))])])])):h("",!0),e("div",it,[e("div",lt,[t[9]||(t[9]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Danh sách tin tuyển dụng",-1)),E(d,{to:"/employer/posts/create",class:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 w-full sm:w-auto"},{default:H(()=>t[8]||(t[8]=[e("i",{class:"fas fa-plus mr-2"},null,-1),v(" Tạo tin mới ")])),_:1})]),k.value?(r(),o("div",ut,t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"},null,-1)]))):c.value.length===0?(r(),o("div",dt,[t[12]||(t[12]=e("i",{class:"fas fa-briefcase text-4xl text-gray-400 mb-4"},null,-1)),t[13]||(t[13]=e("h3",{class:"text-lg font-medium text-gray-900"},"Chưa có tin tuyển dụng nào",-1)),t[14]||(t[14]=e("p",{class:"mt-1 text-sm text-gray-500"},"Bắt đầu bằng cách tạo tin tuyển dụng mới",-1)),e("div",ct,[E(d,{to:"/employer/posts/create",class:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:H(()=>t[11]||(t[11]=[e("i",{class:"fas fa-plus mr-2"},null,-1),v(" Tạo tin mới ")])),_:1})])])):(r(),o("div",gt,[e("div",xt,[e("table",mt,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-medium text-gray-500 uppercase tracking-wider"},"Tin tuyển dụng"),e("th",{class:"px-2 sm:px-6 py-3 text-center text-xs sm:text-sm font-medium text-gray-500 uppercase tracking-wider"},"CV"),e("th",{class:"px-2 sm:px-6 py-3 text-center text-xs sm:text-sm font-medium text-gray-500 uppercase tracking-wider"},"Hạn ứng tuyển"),e("th",{class:"px-4 sm:px-6 py-3 text-center text-xs sm:text-sm font-medium text-gray-500 uppercase tracking-wider"},"Thao tác")])],-1)),e("tbody",ft,[(r(!0),o(V,null,B(c.value,n=>(r(),o("tr",{key:n.id,class:"hover:bg-gray-50"},[e("td",vt,[e("div",yt,l(n.title),1),e("div",pt,[e("span",null,l($(n.created_at)),1),t[15]||(t[15]=e("span",{class:"mx-1"},"•",-1)),e("span",null,l(n.city),1)])]),e("td",bt,[e("span",ht,l(n.total_cvs),1)]),e("td",_t,[e("span",{class:x(["text-xs font-medium px-2 py-1 rounded-full",m(n)?"bg-red-100 text-red-800":"bg-green-100 text-green-800"])},l($(n.deadline)),3)]),e("td",wt,[e("div",kt,[e("button",{onClick:b=>n.is_active?null:X(n),class:x(["text-gray-400 transition-colors duration-200 p-1.5",{"hover:text-blue-500 cursor-pointer":!n.is_active,"opacity-50 cursor-not-allowed":n.is_active}]),title:n.is_active?"Không thể chỉnh sửa bài đăng đang hoạt động":"Chỉnh sửa"},t[16]||(t[16]=[e("i",{class:"fas fa-edit"},null,-1)]),10,Pt),e("button",{onClick:b=>q(n),class:"text-gray-400 hover:text-blue-500 transition-colors duration-200 cursor-pointer p-1.5",title:n.is_active?"Đang hoạt động":m(n)?"Hạn ứng tuyển đã hết":"Đã ẩn"},[e("i",{class:x([n.is_active?"fas fa-toggle-on text-green-500":"fas fa-toggle-off text-gray-400",m(n)&&!n.is_active?"text-red-400":""])},null,2)],8,Ct),e("button",{class:"text-gray-400 hover:text-blue-500 transition-colors duration-200 cursor-pointer p-1.5",title:"Xem chi tiết",onClick:b=>K(n)},t[17]||(t[17]=[e("i",{class:"fas fa-file-alt"},null,-1)]),8,Dt),e("button",{onClick:b=>n.is_active?null:F(n),class:x(["text-gray-400 transition-colors duration-200 p-1.5",{"hover:text-red-500 cursor-pointer":!n.is_active,"opacity-50 cursor-not-allowed":n.is_active}]),title:n.is_active?"Không thể xóa bài đăng đang hoạt động":"Xóa"},t[18]||(t[18]=[e("i",{class:"fas fa-trash"},null,-1)]),10,jt)])])]))),128))])])]),a.value.totalPages>1?(r(),o("div",St,[e("div",$t,[t[20]||(t[20]=v(" Hiển thị ")),e("span",zt,l((a.value.currentPage-1)*a.value.pageSize+1),1),t[21]||(t[21]=v(" đến ")),e("span",Nt,l(Math.min(a.value.currentPage*a.value.pageSize,a.value.totalItems)),1),t[22]||(t[22]=v(" của ")),e("span",Tt,l(a.value.totalItems),1),t[23]||(t[23]=v(" bài đăng "))]),e("div",Et,[e("button",{onClick:t[4]||(t[4]=n=>j(a.value.currentPage-1)),disabled:a.value.currentPage===1,class:"px-3 py-1 border border-gray-300 rounded-md text-sm bg-white text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},t[24]||(t[24]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,Ht),(r(!0),o(V,null,B(I(),n=>(r(),o("button",{key:n,onClick:b=>j(n),class:x(["px-3 py-1 border rounded-md text-sm",n===a.value.currentPage?"bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"])},l(n),11,Vt))),128)),e("button",{onClick:t[5]||(t[5]=n=>j(a.value.currentPage+1)),disabled:a.value.currentPage===a.value.totalPages,class:"px-3 py-1 border border-gray-300 rounded-md text-sm bg-white text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},t[25]||(t[25]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,Bt)])])):h("",!0)]))])])}}};export{Kt as default};
