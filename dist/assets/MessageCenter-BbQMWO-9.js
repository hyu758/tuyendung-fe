import{_ as b,V as _,h as k,B as I,u as C,j as N,Y as y,E as M,k as P,P as d,y as S,r as q,c as a,o as i,d as t,b as v,e as m,f as p,l as f,N as V,w as T,a as U}from"./index-B7EK3ATv.js";import{C as B}from"./ChatContainer-CYaTHQYi.js";const j={class:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-6 px-4 md:py-8"},z={class:"container mx-auto"},A={class:"bg-white rounded-xl shadow-xl overflow-hidden border border-gray-100 transition-all duration-300 hover:shadow-2xl"},L={class:"p-5 md:p-6 border-b bg-gradient-to-r from-indigo-500 to-purple-600"},E={class:"text-xl md:text-2xl font-bold text-white flex items-center"},H={class:"inline-block mr-3 bg-white/20 backdrop-blur-sm text-white p-2 rounded-full"},R={key:0,class:"mt-3 ml-11 flex items-center"},D={key:0,class:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-10",style:{top:"180px"}},F={class:"text-center px-4 py-6 max-w-md mx-auto"},Y={key:1,class:"flex items-center justify-center h-[calc(100vh-220px)] md:h-[calc(100vh-200px)]"},G={key:2,class:"h-[calc(100vh-220px)] md:h-[calc(100vh-200px)] transition-all duration-300 relative"},J={__name:"MessageCenter",setup(K){const c=_(),n=k(),o=I(),u=C(),x=N(!0),w=()=>{var s;return n.isLoggedIn?n.isCandidate?((s=n.userInfo)!=null&&s.is_premium,!0):(u.replace({name:"Home"}),!1):(u.replace({name:"Login",query:{redirect:o.fullPath}}),!1)};y("chatUserId",o.query.user?parseInt(o.query.user,10):null),y("isPremiumUser",M(()=>{var s;return((s=n.userInfo)==null?void 0:s.is_premium)||!1}));const h=s=>{var l;if(c.fetchUnreadMessages(),o.query.user?parseInt(o.query.user,10):null){const r=((l=s.data)==null?void 0:l.type)==="new_message"?s.data:s;parseInt(r.sender_id,10),parseInt(r.recipient_id,10)}};return P(()=>{n.fetchUserProfile().then(()=>{if(w()&&(c.resetStore(),c.fetchUnreadMessages().finally(()=>{setTimeout(()=>{x.value=!1},500)}),d.connected||d.init(),d.onMessage(h),o.query.user)){const s=parseInt(o.query.user,10);isNaN(s)&&u.replace({name:"candidate-messages"})}})}),S(()=>{d.offMessage(h)}),(s,e)=>{var r,g;const l=q("router-link");return i(),a("div",j,[t("div",z,[t("div",A,[t("div",L,[t("h1",E,[t("span",H,[p(f(V),{icon:"comments"})]),e[0]||(e[0]=m(" Tin nhắn của tôi "))]),e[2]||(e[2]=t("p",{class:"text-indigo-100 mt-1 pl-11"}," Trò chuyện với nhà tuyển dụng của bạn ",-1)),(r=f(n).userInfo)!=null&&r.is_premium?v("",!0):(i(),a("div",R,e[1]||(e[1]=[t("div",{class:"bg-yellow-100 text-yellow-800 px-4 py-2 rounded-full text-sm font-medium inline-flex items-center"},[t("i",{class:"fas fa-crown text-yellow-600 mr-2"}),m(" Tính năng dành cho người dùng Premium ")],-1)])))]),(g=f(n).userInfo)!=null&&g.is_premium?v("",!0):(i(),a("div",D,[t("div",F,[e[4]||(e[4]=t("div",{class:"w-24 h-24 mb-4 flex items-center justify-center bg-yellow-50 rounded-full mx-auto"},[t("i",{class:"fas fa-crown text-yellow-500 text-4xl"})],-1)),e[5]||(e[5]=t("h2",{class:"text-xl font-bold text-gray-800 mb-2"},"Tính năng dành cho người dùng Premium",-1)),e[6]||(e[6]=t("p",{class:"text-gray-600 mb-6"},"Để có thể nhắn tin với nhà tuyển dụng, bạn cần nâng cấp tài khoản lên gói Premium.",-1)),p(l,{to:"/premium",class:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2 mx-auto w-max hover:shadow-lg transition duration-300"},{default:T(()=>e[3]||(e[3]=[t("i",{class:"fas fa-crown"},null,-1),m(" Nâng cấp Premium ngay ")])),_:1})])])),x.value?(i(),a("div",Y,e[7]||(e[7]=[U('<div class="flex flex-col items-center space-y-4" data-v-74b87143><svg class="animate-spin h-10 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-74b87143><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-74b87143></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-74b87143></path></svg><span class="text-gray-500" data-v-74b87143>Đang tải tin nhắn...</span></div>',1)]))):(i(),a("div",G,[p(B)]))])])])}}},W=b(J,[["__scopeId","data-v-74b87143"]]);export{W as default};
